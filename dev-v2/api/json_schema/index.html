
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Data validation using Python type hints">
      
      
      
        <link rel="canonical" href="https://docs.pydantic.dev/latest/api/json_schema/">
      
      
        <link rel="prev" href="../functional_validators/">
      
      
        <link rel="next" href="../mypy/">
      
      <link rel="icon" href="../../favicon.png">
      <meta name="generator" content="mkdocs-1.4.3, mkdocs-material-9.1.14">
    
    
      
        <title>pydantic.json_schema - pydantic</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.85bb2934.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a6bdf11c.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../assets/_mkdocstrings.css">
    
      <link rel="stylesheet" href="../../extra/terminal.css">
    
      <link rel="stylesheet" href="../../extra/tweaks.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink">
  
    
    
      <script>var palette=__md_get("__palette");if(palette&&"object"==typeof palette.color)for(var key of Object.keys(palette.color))document.body.setAttribute("data-md-color-"+key,palette.color[key])</script>
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#pydantic.json_schema" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
              <button class="md-banner__button md-icon" aria-label="Don't show this again">
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
              </button>
            
            
  <!-- the following line is displayed in the announce bar -->
<!-- keep length under 164 characters (less HTML tags) to fit on 1280px desktop window -->
We're releasing the first alpha of Pydantic V2 for evaluation. Read the <a href="/blog/pydantic-v2-alpha/">alpha release blog post</a> for details.

          </div>
          
            <script>var content,el=document.querySelector("[data-md-component=announce]");el&&(content=el.querySelector(".md-typeset"),__md_hash(content.innerHTML)===__md_get("__announce")&&(el.hidden=!0))</script>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="pydantic" class="md-header__button md-logo" aria-label="pydantic" data-md-component="logo">
      
  <img src="../../logo-white.svg" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            pydantic
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              pydantic.json_schema
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
            
              <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 1 7 7c0 2.38-1.19 4.47-3 5.74V17a1 1 0 0 1-1 1H9a1 1 0 0 1-1-1v-2.26C6.19 13.47 5 11.38 5 9a7 7 0 0 1 7-7M9 21v-1h6v1a1 1 0 0 1-1 1h-4a1 1 0 0 1-1-1m3-17a5 5 0 0 0-5 5c0 2.05 1.23 3.81 3 4.58V16h4v-2.42c1.77-.77 3-2.53 3-4.58a5 5 0 0 0-5-5Z"/></svg>
              </label>
            
          
            
            
            
            <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="pink" data-md-color-accent="pink"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_2">
            
              <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2a7 7 0 0 0-7 7c0 2.38 1.19 4.47 3 5.74V17a1 1 0 0 0 1 1h6a1 1 0 0 0 1-1v-2.26c1.81-1.27 3-3.36 3-5.74a7 7 0 0 0-7-7M9 21a1 1 0 0 0 1 1h4a1 1 0 0 0 1-1v-1H9v1Z"/></svg>
              </label>
            
          
        </form>
      
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/pydantic/pydantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pydantic/pydantic
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        Get Started
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../usage/models/" class="md-tabs__link">
        Usage
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../errors/errors/" class="md-tabs__link">
        Error Messages
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../integrations/mypy/" class="md-tabs__link">
        Integrations
      </a>
    </li>
  

      
        
  
  


  <li class="md-tabs__item">
    <a href="../../contributing/" class="md-tabs__link">
      Contribute
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../blog/pydantic-v2-alpha/" class="md-tabs__link">
        Blog
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../main/" class="md-tabs__link md-tabs__link--active">
        API Documentation
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="pydantic" class="md-nav__button md-logo" aria-label="pydantic" data-md-component="logo">
      
  <img src="../../logo-white.svg" alt="logo">

    </a>
    pydantic
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/pydantic/pydantic" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2023 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    pydantic/pydantic
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_1" >
      
      
      
        <label class="md-nav__link" for="__nav_1" id="__nav_1_label" tabindex="0">
          Get Started
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_1_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_1">
          <span class="md-nav__icon md-icon"></span>
          Get Started
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Welcome to Pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../install/" class="md-nav__link">
        Installation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../migration/" class="md-nav__link">
        Migration Guide
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../changelog/" class="md-nav__link">
        Changelog
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
          Usage
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Usage
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/models/" class="md-nav__link">
        Models
      </a>
    </li>
  

            
          
            
              
  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_2" >
      
      
      
        <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
          Field Types
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2_2">
          <span class="md-nav__icon md-icon"></span>
          Field Types
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/types/" class="md-nav__link">
        Types Overview
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/standard_types/" class="md-nav__link">
        Standard Library Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/booleans/" class="md-nav__link">
        Booleans
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/bytesize/" class="md-nav__link">
        ByteSize
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/callables/" class="md-nav__link">
        Callables
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/color_types/" class="md-nav__link">
        Color Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/datetime/" class="md-nav__link">
        Datetimes
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/dicts_mapping/" class="md-nav__link">
        Dicts and Mapping
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/encoded/" class="md-nav__link">
        Encoded Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/enums/" class="md-nav__link">
        Enums and Choices
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/file_types/" class="md-nav__link">
        File Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/json/" class="md-nav__link">
        JSON
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/list_types/" class="md-nav__link">
        Lists and Tuples
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/number_types/" class="md-nav__link">
        Number Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/payment_cards/" class="md-nav__link">
        Payment Card Numbers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/secrets/" class="md-nav__link">
        Secret Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/sequence_iterable/" class="md-nav__link">
        Sequence, Iterable, & Iterator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/set_types/" class="md-nav__link">
        Sets and frozenset
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/string_types/" class="md-nav__link">
        String Types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/typevars/" class="md-nav__link">
        Type and TypeVar
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/types_fields/" class="md-nav__link">
        Types with Fields
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/unions/" class="md-nav__link">
        Unions
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/urls/" class="md-nav__link">
        URLs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/uuids/" class="md-nav__link">
        UUIDs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/encoded/" class="md-nav__link">
        Encoded
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/types/custom/" class="md-nav__link">
        Custom Data Types
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/validators/" class="md-nav__link">
        Validators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/model_config/" class="md-nav__link">
        Model Config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/schema/" class="md-nav__link">
        Schema
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/exporting_models/" class="md-nav__link">
        Exporting models
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/computed_fields/" class="md-nav__link">
        Computed fields
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/dataclasses/" class="md-nav__link">
        Dataclasses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/validation_decorator/" class="md-nav__link">
        Validation decorator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/postponed_annotations/" class="md-nav__link">
        Postponed annotations
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/conversion_table/" class="md-nav__link">
        Conversion table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/pydantic_settings/" class="md-nav__link">
        Settings Management
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
      
        <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
          Error Messages
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Error Messages
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../errors/errors/" class="md-nav__link">
        Error Handling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/validation_errors/" class="md-nav__link">
        Validation Errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../usage/errors/" class="md-nav__link">
        Usage Errors
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
      
        <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
          Integrations
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Integrations
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/mypy/" class="md-nav__link">
        Mypy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/pycharm/" class="md-nav__link">
        PyCharm
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/hypothesis/" class="md-nav__link">
        Hypothesis
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/visual_studio_code/" class="md-nav__link">
        Visual Studio Code
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/datamodel_code_generator/" class="md-nav__link">
        datamodel-code-generator
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/devtools/" class="md-nav__link">
        devtools
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../integrations/rich/" class="md-nav__link">
        Rich
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../../contributing/" class="md-nav__link">
        Contribute
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
      
        <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
          Blog
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          Blog
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/pydantic-v2-alpha/" class="md-nav__link">
        Pydantic V2 Pre Release
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../blog/pydantic-v2/" class="md-nav__link">
        Pydantic V2 Plan
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
      
        <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
          API Documentation
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          API Documentation
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../main/" class="md-nav__link">
        pydantic
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alias_generators/" class="md-nav__link">
        pydantic.alias_generators
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../annotated/" class="md-nav__link">
        pydantic.annotated
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../color/" class="md-nav__link">
        pydantic.color
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../config/" class="md-nav__link">
        pydantic.config
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../dataclasses/" class="md-nav__link">
        pydantic.dataclasses
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../errors/" class="md-nav__link">
        pydantic.errors
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fields/" class="md-nav__link">
        pydantic.fields
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../functional_serializers/" class="md-nav__link">
        pydantic.functional_serializers
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../functional_validators/" class="md-nav__link">
        pydantic.functional_validators
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          pydantic.json_schema
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        pydantic.json_schema
      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema" class="md-nav__link">
    pydantic.json_schema
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.CoreSchemaOrFieldType" class="md-nav__link">
    CoreSchemaOrFieldType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.JsonSchemaMode" class="md-nav__link">
    JsonSchemaMode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.JsonSchemaValue" class="md-nav__link">
    JsonSchemaValue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.JsonSchemaWarningKind" class="md-nav__link">
    JsonSchemaWarningKind
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema" class="md-nav__link">
    GenerateJsonSchema
  </a>
  
    <nav class="md-nav" aria-label="GenerateJsonSchema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.ValidationsMapping" class="md-nav__link">
    ValidationsMapping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.any_schema" class="md-nav__link">
    any_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.bool_schema" class="md-nav__link">
    bool_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.build_schema_type_to_method" class="md-nav__link">
    build_schema_type_to_method()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.bytes_schema" class="md-nav__link">
    bytes_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.callable_schema" class="md-nav__link">
    callable_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.date_schema" class="md-nav__link">
    date_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.datetime_schema" class="md-nav__link">
    datetime_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.dict_schema" class="md-nav__link">
    dict_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.emit_warning" class="md-nav__link">
    emit_warning()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.field_is_present" class="md-nav__link">
    field_is_present()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.field_is_required" class="md-nav__link">
    field_is_required()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.field_title_should_be_set" class="md-nav__link">
    field_title_should_be_set()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.float_schema" class="md-nav__link">
    float_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.frozenset_schema" class="md-nav__link">
    frozenset_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generate" class="md-nav__link">
    generate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generate_definitions" class="md-nav__link">
    generate_definitions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generate_inner" class="md-nav__link">
    generate_inner()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generator_schema" class="md-nav__link">
    generator_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.get_cache_defs_ref_schema" class="md-nav__link">
    get_cache_defs_ref_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.get_defs_ref" class="md-nav__link">
    get_defs_ref()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.get_json_ref_counts" class="md-nav__link">
    get_json_ref_counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.handle_ref_overrides" class="md-nav__link">
    handle_ref_overrides()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.int_schema" class="md-nav__link">
    int_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.is_instance_schema" class="md-nav__link">
    is_instance_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.is_subclass_schema" class="md-nav__link">
    is_subclass_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.json_or_python_schema" class="md-nav__link">
    json_or_python_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.lax_or_strict_schema" class="md-nav__link">
    lax_or_strict_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.list_schema" class="md-nav__link">
    list_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.literal_schema" class="md-nav__link">
    literal_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.none_schema" class="md-nav__link">
    none_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.render_warning_message" class="md-nav__link">
    render_warning_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.resolve_collisions" class="md-nav__link">
    resolve_collisions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.set_schema" class="md-nav__link">
    set_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.str_schema" class="md-nav__link">
    str_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.time_schema" class="md-nav__link">
    time_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.timedelta_schema" class="md-nav__link">
    timedelta_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.tuple_positional_schema" class="md-nav__link">
    tuple_positional_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.tuple_variable_schema" class="md-nav__link">
    tuple_variable_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.update_with_validations" class="md-nav__link">
    update_with_validations()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.PydanticJsonSchemaWarning" class="md-nav__link">
    PydanticJsonSchemaWarning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.model_json_schema" class="md-nav__link">
    model_json_schema()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.models_json_schema" class="md-nav__link">
    models_json_schema()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.update_json_schema" class="md-nav__link">
    update_json_schema()
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mypy/" class="md-nav__link">
        pydantic.mypy
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../networks/" class="md-nav__link">
        pydantic.networks
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../type_adapter/" class="md-nav__link">
        pydantic.type_adapter
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../types/" class="md-nav__link">
        pydantic.types
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../validate_call/" class="md-nav__link">
        pydantic.validate_call
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../version/" class="md-nav__link">
        pydantic.version
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pydantic_core_init/" class="md-nav__link">
        pydantic_core.__init__
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../pydantic_core_schema/" class="md-nav__link">
        pydantic_core.core_schema
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="Page contents">
  
  
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Page contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema" class="md-nav__link">
    pydantic.json_schema
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.CoreSchemaOrFieldType" class="md-nav__link">
    CoreSchemaOrFieldType
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.JsonSchemaMode" class="md-nav__link">
    JsonSchemaMode
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.JsonSchemaValue" class="md-nav__link">
    JsonSchemaValue
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.JsonSchemaWarningKind" class="md-nav__link">
    JsonSchemaWarningKind
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema" class="md-nav__link">
    GenerateJsonSchema
  </a>
  
    <nav class="md-nav" aria-label="GenerateJsonSchema">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.ValidationsMapping" class="md-nav__link">
    ValidationsMapping
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.any_schema" class="md-nav__link">
    any_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.bool_schema" class="md-nav__link">
    bool_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.build_schema_type_to_method" class="md-nav__link">
    build_schema_type_to_method()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.bytes_schema" class="md-nav__link">
    bytes_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.callable_schema" class="md-nav__link">
    callable_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.date_schema" class="md-nav__link">
    date_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.datetime_schema" class="md-nav__link">
    datetime_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.dict_schema" class="md-nav__link">
    dict_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.emit_warning" class="md-nav__link">
    emit_warning()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.field_is_present" class="md-nav__link">
    field_is_present()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.field_is_required" class="md-nav__link">
    field_is_required()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.field_title_should_be_set" class="md-nav__link">
    field_title_should_be_set()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.float_schema" class="md-nav__link">
    float_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.frozenset_schema" class="md-nav__link">
    frozenset_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generate" class="md-nav__link">
    generate()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generate_definitions" class="md-nav__link">
    generate_definitions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generate_inner" class="md-nav__link">
    generate_inner()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.generator_schema" class="md-nav__link">
    generator_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.get_cache_defs_ref_schema" class="md-nav__link">
    get_cache_defs_ref_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.get_defs_ref" class="md-nav__link">
    get_defs_ref()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.get_json_ref_counts" class="md-nav__link">
    get_json_ref_counts()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.handle_ref_overrides" class="md-nav__link">
    handle_ref_overrides()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.int_schema" class="md-nav__link">
    int_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.is_instance_schema" class="md-nav__link">
    is_instance_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.is_subclass_schema" class="md-nav__link">
    is_subclass_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.json_or_python_schema" class="md-nav__link">
    json_or_python_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.lax_or_strict_schema" class="md-nav__link">
    lax_or_strict_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.list_schema" class="md-nav__link">
    list_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.literal_schema" class="md-nav__link">
    literal_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.none_schema" class="md-nav__link">
    none_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.render_warning_message" class="md-nav__link">
    render_warning_message()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.resolve_collisions" class="md-nav__link">
    resolve_collisions()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.set_schema" class="md-nav__link">
    set_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.str_schema" class="md-nav__link">
    str_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.time_schema" class="md-nav__link">
    time_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.timedelta_schema" class="md-nav__link">
    timedelta_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.tuple_positional_schema" class="md-nav__link">
    tuple_positional_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.tuple_variable_schema" class="md-nav__link">
    tuple_variable_schema()
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pydantic.json_schema.GenerateJsonSchema.update_with_validations" class="md-nav__link">
    update_with_validations()
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.PydanticJsonSchemaWarning" class="md-nav__link">
    PydanticJsonSchemaWarning
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.model_json_schema" class="md-nav__link">
    model_json_schema()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.models_json_schema" class="md-nav__link">
    models_json_schema()
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#pydantic.json_schema.update_json_schema" class="md-nav__link">
    update_json_schema()
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
  
                  

  
  


  <h1>pydantic.json_schema</h1>

<div class="doc doc-object doc-module">


<a id="pydantic.json_schema"></a>
  <div class="doc doc-contents first">

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h2 id="pydantic.json_schema.CoreSchemaOrFieldType" class="doc doc-heading">
        <span class="doc doc-object-name doc-attribute-name">CoreSchemaOrFieldType</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pydantic.json_schema.CoreSchemaOrFieldType" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">CoreSchemaOrFieldType</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span>
    <span class="n">core_schema</span><span class="o">.</span><span class="n">CoreSchemaType</span><span class="p">,</span>
    <span class="n">core_schema</span><span class="o">.</span><span class="n">CoreSchemaFieldType</span><span class="p">,</span>
<span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>A type alias for defined schema types that represents a union of <code>core_schema.CoreSchemaType</code> and
<code>core_schema.CoreSchemaFieldType</code>.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="pydantic.json_schema.JsonSchemaMode" class="doc doc-heading">
        <span class="doc doc-object-name doc-attribute-name">JsonSchemaMode</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pydantic.json_schema.JsonSchemaMode" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">JsonSchemaMode</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span><span class="s1">&#39;validation&#39;</span><span class="p">,</span> <span class="s1">&#39;serialization&#39;</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>A type alias that represents the mode of a JSON schema; either 'validation' or 'serialization'.</p>
<p>For some types, the inputs to validation differ from the outputs of serialization. For example,
computed fields will only be present when serializing, and should not be provided when
validating. This flag provides a way to indicate whether you want the JSON schema required
for validation inputs, or that will be matched by serialization outputs.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="pydantic.json_schema.JsonSchemaValue" class="doc doc-heading">
        <span class="doc doc-object-name doc-attribute-name">JsonSchemaValue</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pydantic.json_schema.JsonSchemaValue" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>A type alias for a JSON schema value. This is a dictionary of string keys to arbitrary values.</p>
  </div>

</div>

<div class="doc doc-object doc-attribute">



<h2 id="pydantic.json_schema.JsonSchemaWarningKind" class="doc doc-heading">
        <span class="doc doc-object-name doc-attribute-name">JsonSchemaWarningKind</span>

  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-module-attribute"><code>module-attribute</code></small>
  </span>

<a href="#pydantic.json_schema.JsonSchemaWarningKind" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">JsonSchemaWarningKind</span> <span class="o">=</span> <span class="n">Literal</span><span class="p">[</span>
    <span class="s2">&quot;skipped-choice&quot;</span><span class="p">,</span> <span class="s2">&quot;non-serializable-default&quot;</span>
<span class="p">]</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>A type alias representing the kinds of warnings that can be emitted during JSON schema generation.</p>
<p>See <code>GenerateJsonSchema.render_warning_message</code> for more details.</p>
  </div>

</div>


<div class="doc doc-object doc-class">



<h2 id="pydantic.json_schema.GenerateJsonSchema" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">GenerateJsonSchema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">

  
      <p>A class for generating JSON schemas.</p>
<p>This class generates JSON schemas based on configured parameters. The default schema dialect
is 'https://json-schema.org/draft/2020-12/schema'. The class uses <code>by_alias</code> to configure how fields with
multiple names are handled and <code>ref_template</code> to format reference names.</p>

  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema_dialect</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The JSON schema dialect used to generate the schema. See
<a href="https://json-schema.org/understanding-json-schema/reference/schema.html#id4">Declaring a Dialect</a>
in the JSON Schema documentation for more information about dialects.</p></td>
        </tr>
        <tr>
          <td><code>ignored_warning_kinds</code></td>
          <td>
                <code>set</code>
          </td>
          <td><p>Warnings to ignore when generating the schema. <code>self.render_warning_message</code> will
do nothing if its argument <code>kind</code> is in <code>ignored_warning_kinds</code>;
this value can be modified on subclasses to easily control which warnings are emitted.</p></td>
        </tr>
        <tr>
          <td><code>by_alias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether or not to use field names when generating the schema.</p></td>
        </tr>
        <tr>
          <td><code>ref_template</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The format string used when generating reference names.</p></td>
        </tr>
        <tr>
          <td><code>core_to_json_refs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>A mapping of core refs to JSON refs.</p></td>
        </tr>
        <tr>
          <td><code>core_to_defs_refs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>A mapping of core refs to definition refs.</p></td>
        </tr>
        <tr>
          <td><code>defs_to_core_refs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>A mapping of definition refs to core refs.</p></td>
        </tr>
        <tr>
          <td><code>json_to_defs_refs</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>A mapping of JSON refs to definition refs.</p></td>
        </tr>
        <tr>
          <td><code>definitions</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Definitions in the schema.</p></td>
        </tr>
        <tr>
          <td><code>collisions</code></td>
          <td>
                <code>set</code>
          </td>
          <td><p>Definitions with colliding names. When collisions are detected, we choose a non-colliding
name during generation, but we also track the colliding tag so that it can be remapped for the first
occurrence at the end of the process.</p></td>
        </tr>
        <tr>
          <td><code>defs_ref_fallbacks</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>Core refs to fallback definitions refs.</p></td>
        </tr>
        <tr>
          <td><code>_schema_type_to_method</code></td>
          <td>
                <code>dict</code>
          </td>
          <td><p>A mapping of schema types to generator methods.</p></td>
        </tr>
        <tr>
          <td><code>_used</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Set to <code>True</code> after generating a schema to avoid re-use issues.</p></td>
        </tr>
        <tr>
          <td><code>mode</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaMode" href="#pydantic.json_schema.JsonSchemaMode">JsonSchemaMode</a></code>
          </td>
          <td><p>The schema mode.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>by_alias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether or not to include field names.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>ref_template</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The format string to use when generating reference names.</p></td>
          <td>
                <code>DEFAULT_REF_TEMPLATE</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>JsonSchemaError</code>
          </td>
          <td><p>If the instance of the class is inadvertently re-used after generating a schema.</p></td>
        </tr>
    </tbody>
  </table>


        <details class="quote">
          <summary>Source code in <code>pydantic/json_schema.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 120</span>
<span class="normal"> 121</span>
<span class="normal"> 122</span>
<span class="normal"> 123</span>
<span class="normal"> 124</span>
<span class="normal"> 125</span>
<span class="normal"> 126</span>
<span class="normal"> 127</span>
<span class="normal"> 128</span>
<span class="normal"> 129</span>
<span class="normal"> 130</span>
<span class="normal"> 131</span>
<span class="normal"> 132</span>
<span class="normal"> 133</span>
<span class="normal"> 134</span>
<span class="normal"> 135</span>
<span class="normal"> 136</span>
<span class="normal"> 137</span>
<span class="normal"> 138</span>
<span class="normal"> 139</span>
<span class="normal"> 140</span>
<span class="normal"> 141</span>
<span class="normal"> 142</span>
<span class="normal"> 143</span>
<span class="normal"> 144</span>
<span class="normal"> 145</span>
<span class="normal"> 146</span>
<span class="normal"> 147</span>
<span class="normal"> 148</span>
<span class="normal"> 149</span>
<span class="normal"> 150</span>
<span class="normal"> 151</span>
<span class="normal"> 152</span>
<span class="normal"> 153</span>
<span class="normal"> 154</span>
<span class="normal"> 155</span>
<span class="normal"> 156</span>
<span class="normal"> 157</span>
<span class="normal"> 158</span>
<span class="normal"> 159</span>
<span class="normal"> 160</span>
<span class="normal"> 161</span>
<span class="normal"> 162</span>
<span class="normal"> 163</span>
<span class="normal"> 164</span>
<span class="normal"> 165</span>
<span class="normal"> 166</span>
<span class="normal"> 167</span>
<span class="normal"> 168</span>
<span class="normal"> 169</span>
<span class="normal"> 170</span>
<span class="normal"> 171</span>
<span class="normal"> 172</span>
<span class="normal"> 173</span>
<span class="normal"> 174</span>
<span class="normal"> 175</span>
<span class="normal"> 176</span>
<span class="normal"> 177</span>
<span class="normal"> 178</span>
<span class="normal"> 179</span>
<span class="normal"> 180</span>
<span class="normal"> 181</span>
<span class="normal"> 182</span>
<span class="normal"> 183</span>
<span class="normal"> 184</span>
<span class="normal"> 185</span>
<span class="normal"> 186</span>
<span class="normal"> 187</span>
<span class="normal"> 188</span>
<span class="normal"> 189</span>
<span class="normal"> 190</span>
<span class="normal"> 191</span>
<span class="normal"> 192</span>
<span class="normal"> 193</span>
<span class="normal"> 194</span>
<span class="normal"> 195</span>
<span class="normal"> 196</span>
<span class="normal"> 197</span>
<span class="normal"> 198</span>
<span class="normal"> 199</span>
<span class="normal"> 200</span>
<span class="normal"> 201</span>
<span class="normal"> 202</span>
<span class="normal"> 203</span>
<span class="normal"> 204</span>
<span class="normal"> 205</span>
<span class="normal"> 206</span>
<span class="normal"> 207</span>
<span class="normal"> 208</span>
<span class="normal"> 209</span>
<span class="normal"> 210</span>
<span class="normal"> 211</span>
<span class="normal"> 212</span>
<span class="normal"> 213</span>
<span class="normal"> 214</span>
<span class="normal"> 215</span>
<span class="normal"> 216</span>
<span class="normal"> 217</span>
<span class="normal"> 218</span>
<span class="normal"> 219</span>
<span class="normal"> 220</span>
<span class="normal"> 221</span>
<span class="normal"> 222</span>
<span class="normal"> 223</span>
<span class="normal"> 224</span>
<span class="normal"> 225</span>
<span class="normal"> 226</span>
<span class="normal"> 227</span>
<span class="normal"> 228</span>
<span class="normal"> 229</span>
<span class="normal"> 230</span>
<span class="normal"> 231</span>
<span class="normal"> 232</span>
<span class="normal"> 233</span>
<span class="normal"> 234</span>
<span class="normal"> 235</span>
<span class="normal"> 236</span>
<span class="normal"> 237</span>
<span class="normal"> 238</span>
<span class="normal"> 239</span>
<span class="normal"> 240</span>
<span class="normal"> 241</span>
<span class="normal"> 242</span>
<span class="normal"> 243</span>
<span class="normal"> 244</span>
<span class="normal"> 245</span>
<span class="normal"> 246</span>
<span class="normal"> 247</span>
<span class="normal"> 248</span>
<span class="normal"> 249</span>
<span class="normal"> 250</span>
<span class="normal"> 251</span>
<span class="normal"> 252</span>
<span class="normal"> 253</span>
<span class="normal"> 254</span>
<span class="normal"> 255</span>
<span class="normal"> 256</span>
<span class="normal"> 257</span>
<span class="normal"> 258</span>
<span class="normal"> 259</span>
<span class="normal"> 260</span>
<span class="normal"> 261</span>
<span class="normal"> 262</span>
<span class="normal"> 263</span>
<span class="normal"> 264</span>
<span class="normal"> 265</span>
<span class="normal"> 266</span>
<span class="normal"> 267</span>
<span class="normal"> 268</span>
<span class="normal"> 269</span>
<span class="normal"> 270</span>
<span class="normal"> 271</span>
<span class="normal"> 272</span>
<span class="normal"> 273</span>
<span class="normal"> 274</span>
<span class="normal"> 275</span>
<span class="normal"> 276</span>
<span class="normal"> 277</span>
<span class="normal"> 278</span>
<span class="normal"> 279</span>
<span class="normal"> 280</span>
<span class="normal"> 281</span>
<span class="normal"> 282</span>
<span class="normal"> 283</span>
<span class="normal"> 284</span>
<span class="normal"> 285</span>
<span class="normal"> 286</span>
<span class="normal"> 287</span>
<span class="normal"> 288</span>
<span class="normal"> 289</span>
<span class="normal"> 290</span>
<span class="normal"> 291</span>
<span class="normal"> 292</span>
<span class="normal"> 293</span>
<span class="normal"> 294</span>
<span class="normal"> 295</span>
<span class="normal"> 296</span>
<span class="normal"> 297</span>
<span class="normal"> 298</span>
<span class="normal"> 299</span>
<span class="normal"> 300</span>
<span class="normal"> 301</span>
<span class="normal"> 302</span>
<span class="normal"> 303</span>
<span class="normal"> 304</span>
<span class="normal"> 305</span>
<span class="normal"> 306</span>
<span class="normal"> 307</span>
<span class="normal"> 308</span>
<span class="normal"> 309</span>
<span class="normal"> 310</span>
<span class="normal"> 311</span>
<span class="normal"> 312</span>
<span class="normal"> 313</span>
<span class="normal"> 314</span>
<span class="normal"> 315</span>
<span class="normal"> 316</span>
<span class="normal"> 317</span>
<span class="normal"> 318</span>
<span class="normal"> 319</span>
<span class="normal"> 320</span>
<span class="normal"> 321</span>
<span class="normal"> 322</span>
<span class="normal"> 323</span>
<span class="normal"> 324</span>
<span class="normal"> 325</span>
<span class="normal"> 326</span>
<span class="normal"> 327</span>
<span class="normal"> 328</span>
<span class="normal"> 329</span>
<span class="normal"> 330</span>
<span class="normal"> 331</span>
<span class="normal"> 332</span>
<span class="normal"> 333</span>
<span class="normal"> 334</span>
<span class="normal"> 335</span>
<span class="normal"> 336</span>
<span class="normal"> 337</span>
<span class="normal"> 338</span>
<span class="normal"> 339</span>
<span class="normal"> 340</span>
<span class="normal"> 341</span>
<span class="normal"> 342</span>
<span class="normal"> 343</span>
<span class="normal"> 344</span>
<span class="normal"> 345</span>
<span class="normal"> 346</span>
<span class="normal"> 347</span>
<span class="normal"> 348</span>
<span class="normal"> 349</span>
<span class="normal"> 350</span>
<span class="normal"> 351</span>
<span class="normal"> 352</span>
<span class="normal"> 353</span>
<span class="normal"> 354</span>
<span class="normal"> 355</span>
<span class="normal"> 356</span>
<span class="normal"> 357</span>
<span class="normal"> 358</span>
<span class="normal"> 359</span>
<span class="normal"> 360</span>
<span class="normal"> 361</span>
<span class="normal"> 362</span>
<span class="normal"> 363</span>
<span class="normal"> 364</span>
<span class="normal"> 365</span>
<span class="normal"> 366</span>
<span class="normal"> 367</span>
<span class="normal"> 368</span>
<span class="normal"> 369</span>
<span class="normal"> 370</span>
<span class="normal"> 371</span>
<span class="normal"> 372</span>
<span class="normal"> 373</span>
<span class="normal"> 374</span>
<span class="normal"> 375</span>
<span class="normal"> 376</span>
<span class="normal"> 377</span>
<span class="normal"> 378</span>
<span class="normal"> 379</span>
<span class="normal"> 380</span>
<span class="normal"> 381</span>
<span class="normal"> 382</span>
<span class="normal"> 383</span>
<span class="normal"> 384</span>
<span class="normal"> 385</span>
<span class="normal"> 386</span>
<span class="normal"> 387</span>
<span class="normal"> 388</span>
<span class="normal"> 389</span>
<span class="normal"> 390</span>
<span class="normal"> 391</span>
<span class="normal"> 392</span>
<span class="normal"> 393</span>
<span class="normal"> 394</span>
<span class="normal"> 395</span>
<span class="normal"> 396</span>
<span class="normal"> 397</span>
<span class="normal"> 398</span>
<span class="normal"> 399</span>
<span class="normal"> 400</span>
<span class="normal"> 401</span>
<span class="normal"> 402</span>
<span class="normal"> 403</span>
<span class="normal"> 404</span>
<span class="normal"> 405</span>
<span class="normal"> 406</span>
<span class="normal"> 407</span>
<span class="normal"> 408</span>
<span class="normal"> 409</span>
<span class="normal"> 410</span>
<span class="normal"> 411</span>
<span class="normal"> 412</span>
<span class="normal"> 413</span>
<span class="normal"> 414</span>
<span class="normal"> 415</span>
<span class="normal"> 416</span>
<span class="normal"> 417</span>
<span class="normal"> 418</span>
<span class="normal"> 419</span>
<span class="normal"> 420</span>
<span class="normal"> 421</span>
<span class="normal"> 422</span>
<span class="normal"> 423</span>
<span class="normal"> 424</span>
<span class="normal"> 425</span>
<span class="normal"> 426</span>
<span class="normal"> 427</span>
<span class="normal"> 428</span>
<span class="normal"> 429</span>
<span class="normal"> 430</span>
<span class="normal"> 431</span>
<span class="normal"> 432</span>
<span class="normal"> 433</span>
<span class="normal"> 434</span>
<span class="normal"> 435</span>
<span class="normal"> 436</span>
<span class="normal"> 437</span>
<span class="normal"> 438</span>
<span class="normal"> 439</span>
<span class="normal"> 440</span>
<span class="normal"> 441</span>
<span class="normal"> 442</span>
<span class="normal"> 443</span>
<span class="normal"> 444</span>
<span class="normal"> 445</span>
<span class="normal"> 446</span>
<span class="normal"> 447</span>
<span class="normal"> 448</span>
<span class="normal"> 449</span>
<span class="normal"> 450</span>
<span class="normal"> 451</span>
<span class="normal"> 452</span>
<span class="normal"> 453</span>
<span class="normal"> 454</span>
<span class="normal"> 455</span>
<span class="normal"> 456</span>
<span class="normal"> 457</span>
<span class="normal"> 458</span>
<span class="normal"> 459</span>
<span class="normal"> 460</span>
<span class="normal"> 461</span>
<span class="normal"> 462</span>
<span class="normal"> 463</span>
<span class="normal"> 464</span>
<span class="normal"> 465</span>
<span class="normal"> 466</span>
<span class="normal"> 467</span>
<span class="normal"> 468</span>
<span class="normal"> 469</span>
<span class="normal"> 470</span>
<span class="normal"> 471</span>
<span class="normal"> 472</span>
<span class="normal"> 473</span>
<span class="normal"> 474</span>
<span class="normal"> 475</span>
<span class="normal"> 476</span>
<span class="normal"> 477</span>
<span class="normal"> 478</span>
<span class="normal"> 479</span>
<span class="normal"> 480</span>
<span class="normal"> 481</span>
<span class="normal"> 482</span>
<span class="normal"> 483</span>
<span class="normal"> 484</span>
<span class="normal"> 485</span>
<span class="normal"> 486</span>
<span class="normal"> 487</span>
<span class="normal"> 488</span>
<span class="normal"> 489</span>
<span class="normal"> 490</span>
<span class="normal"> 491</span>
<span class="normal"> 492</span>
<span class="normal"> 493</span>
<span class="normal"> 494</span>
<span class="normal"> 495</span>
<span class="normal"> 496</span>
<span class="normal"> 497</span>
<span class="normal"> 498</span>
<span class="normal"> 499</span>
<span class="normal"> 500</span>
<span class="normal"> 501</span>
<span class="normal"> 502</span>
<span class="normal"> 503</span>
<span class="normal"> 504</span>
<span class="normal"> 505</span>
<span class="normal"> 506</span>
<span class="normal"> 507</span>
<span class="normal"> 508</span>
<span class="normal"> 509</span>
<span class="normal"> 510</span>
<span class="normal"> 511</span>
<span class="normal"> 512</span>
<span class="normal"> 513</span>
<span class="normal"> 514</span>
<span class="normal"> 515</span>
<span class="normal"> 516</span>
<span class="normal"> 517</span>
<span class="normal"> 518</span>
<span class="normal"> 519</span>
<span class="normal"> 520</span>
<span class="normal"> 521</span>
<span class="normal"> 522</span>
<span class="normal"> 523</span>
<span class="normal"> 524</span>
<span class="normal"> 525</span>
<span class="normal"> 526</span>
<span class="normal"> 527</span>
<span class="normal"> 528</span>
<span class="normal"> 529</span>
<span class="normal"> 530</span>
<span class="normal"> 531</span>
<span class="normal"> 532</span>
<span class="normal"> 533</span>
<span class="normal"> 534</span>
<span class="normal"> 535</span>
<span class="normal"> 536</span>
<span class="normal"> 537</span>
<span class="normal"> 538</span>
<span class="normal"> 539</span>
<span class="normal"> 540</span>
<span class="normal"> 541</span>
<span class="normal"> 542</span>
<span class="normal"> 543</span>
<span class="normal"> 544</span>
<span class="normal"> 545</span>
<span class="normal"> 546</span>
<span class="normal"> 547</span>
<span class="normal"> 548</span>
<span class="normal"> 549</span>
<span class="normal"> 550</span>
<span class="normal"> 551</span>
<span class="normal"> 552</span>
<span class="normal"> 553</span>
<span class="normal"> 554</span>
<span class="normal"> 555</span>
<span class="normal"> 556</span>
<span class="normal"> 557</span>
<span class="normal"> 558</span>
<span class="normal"> 559</span>
<span class="normal"> 560</span>
<span class="normal"> 561</span>
<span class="normal"> 562</span>
<span class="normal"> 563</span>
<span class="normal"> 564</span>
<span class="normal"> 565</span>
<span class="normal"> 566</span>
<span class="normal"> 567</span>
<span class="normal"> 568</span>
<span class="normal"> 569</span>
<span class="normal"> 570</span>
<span class="normal"> 571</span>
<span class="normal"> 572</span>
<span class="normal"> 573</span>
<span class="normal"> 574</span>
<span class="normal"> 575</span>
<span class="normal"> 576</span>
<span class="normal"> 577</span>
<span class="normal"> 578</span>
<span class="normal"> 579</span>
<span class="normal"> 580</span>
<span class="normal"> 581</span>
<span class="normal"> 582</span>
<span class="normal"> 583</span>
<span class="normal"> 584</span>
<span class="normal"> 585</span>
<span class="normal"> 586</span>
<span class="normal"> 587</span>
<span class="normal"> 588</span>
<span class="normal"> 589</span>
<span class="normal"> 590</span>
<span class="normal"> 591</span>
<span class="normal"> 592</span>
<span class="normal"> 593</span>
<span class="normal"> 594</span>
<span class="normal"> 595</span>
<span class="normal"> 596</span>
<span class="normal"> 597</span>
<span class="normal"> 598</span>
<span class="normal"> 599</span>
<span class="normal"> 600</span>
<span class="normal"> 601</span>
<span class="normal"> 602</span>
<span class="normal"> 603</span>
<span class="normal"> 604</span>
<span class="normal"> 605</span>
<span class="normal"> 606</span>
<span class="normal"> 607</span>
<span class="normal"> 608</span>
<span class="normal"> 609</span>
<span class="normal"> 610</span>
<span class="normal"> 611</span>
<span class="normal"> 612</span>
<span class="normal"> 613</span>
<span class="normal"> 614</span>
<span class="normal"> 615</span>
<span class="normal"> 616</span>
<span class="normal"> 617</span>
<span class="normal"> 618</span>
<span class="normal"> 619</span>
<span class="normal"> 620</span>
<span class="normal"> 621</span>
<span class="normal"> 622</span>
<span class="normal"> 623</span>
<span class="normal"> 624</span>
<span class="normal"> 625</span>
<span class="normal"> 626</span>
<span class="normal"> 627</span>
<span class="normal"> 628</span>
<span class="normal"> 629</span>
<span class="normal"> 630</span>
<span class="normal"> 631</span>
<span class="normal"> 632</span>
<span class="normal"> 633</span>
<span class="normal"> 634</span>
<span class="normal"> 635</span>
<span class="normal"> 636</span>
<span class="normal"> 637</span>
<span class="normal"> 638</span>
<span class="normal"> 639</span>
<span class="normal"> 640</span>
<span class="normal"> 641</span>
<span class="normal"> 642</span>
<span class="normal"> 643</span>
<span class="normal"> 644</span>
<span class="normal"> 645</span>
<span class="normal"> 646</span>
<span class="normal"> 647</span>
<span class="normal"> 648</span>
<span class="normal"> 649</span>
<span class="normal"> 650</span>
<span class="normal"> 651</span>
<span class="normal"> 652</span>
<span class="normal"> 653</span>
<span class="normal"> 654</span>
<span class="normal"> 655</span>
<span class="normal"> 656</span>
<span class="normal"> 657</span>
<span class="normal"> 658</span>
<span class="normal"> 659</span>
<span class="normal"> 660</span>
<span class="normal"> 661</span>
<span class="normal"> 662</span>
<span class="normal"> 663</span>
<span class="normal"> 664</span>
<span class="normal"> 665</span>
<span class="normal"> 666</span>
<span class="normal"> 667</span>
<span class="normal"> 668</span>
<span class="normal"> 669</span>
<span class="normal"> 670</span>
<span class="normal"> 671</span>
<span class="normal"> 672</span>
<span class="normal"> 673</span>
<span class="normal"> 674</span>
<span class="normal"> 675</span>
<span class="normal"> 676</span>
<span class="normal"> 677</span>
<span class="normal"> 678</span>
<span class="normal"> 679</span>
<span class="normal"> 680</span>
<span class="normal"> 681</span>
<span class="normal"> 682</span>
<span class="normal"> 683</span>
<span class="normal"> 684</span>
<span class="normal"> 685</span>
<span class="normal"> 686</span>
<span class="normal"> 687</span>
<span class="normal"> 688</span>
<span class="normal"> 689</span>
<span class="normal"> 690</span>
<span class="normal"> 691</span>
<span class="normal"> 692</span>
<span class="normal"> 693</span>
<span class="normal"> 694</span>
<span class="normal"> 695</span>
<span class="normal"> 696</span>
<span class="normal"> 697</span>
<span class="normal"> 698</span>
<span class="normal"> 699</span>
<span class="normal"> 700</span>
<span class="normal"> 701</span>
<span class="normal"> 702</span>
<span class="normal"> 703</span>
<span class="normal"> 704</span>
<span class="normal"> 705</span>
<span class="normal"> 706</span>
<span class="normal"> 707</span>
<span class="normal"> 708</span>
<span class="normal"> 709</span>
<span class="normal"> 710</span>
<span class="normal"> 711</span>
<span class="normal"> 712</span>
<span class="normal"> 713</span>
<span class="normal"> 714</span>
<span class="normal"> 715</span>
<span class="normal"> 716</span>
<span class="normal"> 717</span>
<span class="normal"> 718</span>
<span class="normal"> 719</span>
<span class="normal"> 720</span>
<span class="normal"> 721</span>
<span class="normal"> 722</span>
<span class="normal"> 723</span>
<span class="normal"> 724</span>
<span class="normal"> 725</span>
<span class="normal"> 726</span>
<span class="normal"> 727</span>
<span class="normal"> 728</span>
<span class="normal"> 729</span>
<span class="normal"> 730</span>
<span class="normal"> 731</span>
<span class="normal"> 732</span>
<span class="normal"> 733</span>
<span class="normal"> 734</span>
<span class="normal"> 735</span>
<span class="normal"> 736</span>
<span class="normal"> 737</span>
<span class="normal"> 738</span>
<span class="normal"> 739</span>
<span class="normal"> 740</span>
<span class="normal"> 741</span>
<span class="normal"> 742</span>
<span class="normal"> 743</span>
<span class="normal"> 744</span>
<span class="normal"> 745</span>
<span class="normal"> 746</span>
<span class="normal"> 747</span>
<span class="normal"> 748</span>
<span class="normal"> 749</span>
<span class="normal"> 750</span>
<span class="normal"> 751</span>
<span class="normal"> 752</span>
<span class="normal"> 753</span>
<span class="normal"> 754</span>
<span class="normal"> 755</span>
<span class="normal"> 756</span>
<span class="normal"> 757</span>
<span class="normal"> 758</span>
<span class="normal"> 759</span>
<span class="normal"> 760</span>
<span class="normal"> 761</span>
<span class="normal"> 762</span>
<span class="normal"> 763</span>
<span class="normal"> 764</span>
<span class="normal"> 765</span>
<span class="normal"> 766</span>
<span class="normal"> 767</span>
<span class="normal"> 768</span>
<span class="normal"> 769</span>
<span class="normal"> 770</span>
<span class="normal"> 771</span>
<span class="normal"> 772</span>
<span class="normal"> 773</span>
<span class="normal"> 774</span>
<span class="normal"> 775</span>
<span class="normal"> 776</span>
<span class="normal"> 777</span>
<span class="normal"> 778</span>
<span class="normal"> 779</span>
<span class="normal"> 780</span>
<span class="normal"> 781</span>
<span class="normal"> 782</span>
<span class="normal"> 783</span>
<span class="normal"> 784</span>
<span class="normal"> 785</span>
<span class="normal"> 786</span>
<span class="normal"> 787</span>
<span class="normal"> 788</span>
<span class="normal"> 789</span>
<span class="normal"> 790</span>
<span class="normal"> 791</span>
<span class="normal"> 792</span>
<span class="normal"> 793</span>
<span class="normal"> 794</span>
<span class="normal"> 795</span>
<span class="normal"> 796</span>
<span class="normal"> 797</span>
<span class="normal"> 798</span>
<span class="normal"> 799</span>
<span class="normal"> 800</span>
<span class="normal"> 801</span>
<span class="normal"> 802</span>
<span class="normal"> 803</span>
<span class="normal"> 804</span>
<span class="normal"> 805</span>
<span class="normal"> 806</span>
<span class="normal"> 807</span>
<span class="normal"> 808</span>
<span class="normal"> 809</span>
<span class="normal"> 810</span>
<span class="normal"> 811</span>
<span class="normal"> 812</span>
<span class="normal"> 813</span>
<span class="normal"> 814</span>
<span class="normal"> 815</span>
<span class="normal"> 816</span>
<span class="normal"> 817</span>
<span class="normal"> 818</span>
<span class="normal"> 819</span>
<span class="normal"> 820</span>
<span class="normal"> 821</span>
<span class="normal"> 822</span>
<span class="normal"> 823</span>
<span class="normal"> 824</span>
<span class="normal"> 825</span>
<span class="normal"> 826</span>
<span class="normal"> 827</span>
<span class="normal"> 828</span>
<span class="normal"> 829</span>
<span class="normal"> 830</span>
<span class="normal"> 831</span>
<span class="normal"> 832</span>
<span class="normal"> 833</span>
<span class="normal"> 834</span>
<span class="normal"> 835</span>
<span class="normal"> 836</span>
<span class="normal"> 837</span>
<span class="normal"> 838</span>
<span class="normal"> 839</span>
<span class="normal"> 840</span>
<span class="normal"> 841</span>
<span class="normal"> 842</span>
<span class="normal"> 843</span>
<span class="normal"> 844</span>
<span class="normal"> 845</span>
<span class="normal"> 846</span>
<span class="normal"> 847</span>
<span class="normal"> 848</span>
<span class="normal"> 849</span>
<span class="normal"> 850</span>
<span class="normal"> 851</span>
<span class="normal"> 852</span>
<span class="normal"> 853</span>
<span class="normal"> 854</span>
<span class="normal"> 855</span>
<span class="normal"> 856</span>
<span class="normal"> 857</span>
<span class="normal"> 858</span>
<span class="normal"> 859</span>
<span class="normal"> 860</span>
<span class="normal"> 861</span>
<span class="normal"> 862</span>
<span class="normal"> 863</span>
<span class="normal"> 864</span>
<span class="normal"> 865</span>
<span class="normal"> 866</span>
<span class="normal"> 867</span>
<span class="normal"> 868</span>
<span class="normal"> 869</span>
<span class="normal"> 870</span>
<span class="normal"> 871</span>
<span class="normal"> 872</span>
<span class="normal"> 873</span>
<span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span>
<span class="normal">1182</span>
<span class="normal">1183</span>
<span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GenerateJsonSchema</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for generating JSON schemas.</span>

<span class="sd">    This class generates JSON schemas based on configured parameters. The default schema dialect</span>
<span class="sd">    is &#39;https://json-schema.org/draft/2020-12/schema&#39;. The class uses `by_alias` to configure how fields with</span>
<span class="sd">    multiple names are handled and `ref_template` to format reference names.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        schema_dialect (str): The JSON schema dialect used to generate the schema. See</span>
<span class="sd">            [Declaring a Dialect](https://json-schema.org/understanding-json-schema/reference/schema.html#id4)</span>
<span class="sd">            in the JSON Schema documentation for more information about dialects.</span>
<span class="sd">        ignored_warning_kinds (set): Warnings to ignore when generating the schema. `self.render_warning_message` will</span>
<span class="sd">            do nothing if its argument `kind` is in `ignored_warning_kinds`;</span>
<span class="sd">            this value can be modified on subclasses to easily control which warnings are emitted.</span>
<span class="sd">        by_alias (bool): Whether or not to use field names when generating the schema.</span>
<span class="sd">        ref_template (str): The format string used when generating reference names.</span>
<span class="sd">        core_to_json_refs (dict): A mapping of core refs to JSON refs.</span>
<span class="sd">        core_to_defs_refs (dict): A mapping of core refs to definition refs.</span>
<span class="sd">        defs_to_core_refs (dict): A mapping of definition refs to core refs.</span>
<span class="sd">        json_to_defs_refs (dict): A mapping of JSON refs to definition refs.</span>
<span class="sd">        definitions (dict): Definitions in the schema.</span>
<span class="sd">        collisions (set): Definitions with colliding names. When collisions are detected, we choose a non-colliding</span>
<span class="sd">            name during generation, but we also track the colliding tag so that it can be remapped for the first</span>
<span class="sd">            occurrence at the end of the process.</span>
<span class="sd">        defs_ref_fallbacks (dict): Core refs to fallback definitions refs.</span>
<span class="sd">        _schema_type_to_method (dict): A mapping of schema types to generator methods.</span>
<span class="sd">        _used (bool): Set to `True` after generating a schema to avoid re-use issues.</span>
<span class="sd">        mode (JsonSchemaMode): The schema mode.</span>

<span class="sd">    Args:</span>
<span class="sd">        by_alias (bool): Whether or not to include field names.</span>
<span class="sd">        ref_template (str): The format string to use when generating reference names.</span>

<span class="sd">    Raises:</span>
<span class="sd">        JsonSchemaError: If the instance of the class is inadvertently re-used after generating a schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">schema_dialect</span> <span class="o">=</span> <span class="s1">&#39;https://json-schema.org/draft/2020-12/schema&#39;</span>

    <span class="c1"># `self.render_warning_message` will do nothing if its argument `kind` is in `ignored_warning_kinds`;</span>
    <span class="c1"># this value can be modified on subclasses to easily control which warnings are emitted</span>
    <span class="n">ignored_warning_kinds</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">JsonSchemaWarningKind</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;skipped-choice&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">ref_template</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_REF_TEMPLATE</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">by_alias</span> <span class="o">=</span> <span class="n">by_alias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">ref_template</span> <span class="o">=</span> <span class="n">ref_template</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreModeRef</span><span class="p">,</span> <span class="n">JsonRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreModeRef</span><span class="p">,</span> <span class="n">DefsRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">,</span> <span class="n">CoreModeRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">DefsRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="c1"># When collisions are detected, we choose a non-colliding name</span>
        <span class="c1"># during generation, but we also track the colliding tag so that it</span>
        <span class="c1"># can be remapped for the first occurrence at the end of the process</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="p">:</span> <span class="nb">set</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">]</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs_ref_fallbacks</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreModeRef</span><span class="p">,</span> <span class="nb">list</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type_to_method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">build_schema_type_to_method</span><span class="p">()</span>

        <span class="c1"># This changes to True after generating a schema, to prevent issues caused by accidental re-use</span>
        <span class="c1"># of a single instance of a schema generator</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_used</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">:</span> <span class="n">JsonSchemaMode</span> <span class="o">=</span> <span class="s1">&#39;validation&#39;</span>

    <span class="k">def</span> <span class="nf">build_schema_type_to_method</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreSchemaOrFieldType</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoreSchemaOrField</span><span class="p">],</span> <span class="n">JsonSchemaValue</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Builds a dictionary mapping `CoreSchemaOrFieldType` to a callable method that generates a `JsonSchema` value</span>
<span class="sd">        for a given `CoreSchemaOrField`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: A dictionary containing the mapping of `CoreSchemaOrFieldType` to a callable method.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If no method has been defined for generating a JSON schema for a given pydantic core schema type.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreSchemaOrFieldType</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoreSchemaOrField</span><span class="p">],</span> <span class="n">JsonSchemaValue</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">core_schema_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoreSchemaOrFieldType</span><span class="p">]</span> <span class="o">=</span> <span class="n">_typing_extra</span><span class="o">.</span><span class="n">all_literal_values</span><span class="p">(</span>
            <span class="n">CoreSchemaOrFieldType</span>  <span class="c1"># type: ignore</span>
        <span class="p">)</span>
        <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">core_schema_types</span><span class="p">:</span>
            <span class="n">method_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_schema&quot;</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s1">&#39;No method for generating JsonSchema for core_schema.type=</span><span class="si">{</span><span class="n">key</span><span class="si">!r}</span><span class="s1"> &#39;</span>
                    <span class="sa">f</span><span class="s1">&#39;(expected: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s1">)&#39;</span>
                <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
        <span class="k">return</span> <span class="n">mapping</span>

    <span class="k">def</span> <span class="nf">generate_definitions</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">JsonSchemaKeyT</span><span class="p">,</span> <span class="n">JsonSchemaMode</span><span class="p">,</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">CoreSchema</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">JsonSchemaKeyT</span><span class="p">,</span> <span class="n">JsonSchemaMode</span><span class="p">],</span> <span class="n">DefsRef</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Given a list of core_schema, generates all JSON schema definitions from a list of core schemas, and</span>
<span class="sd">        returns the generated definitions paired with a mapping from the input keys to the definition references.</span>

<span class="sd">        Args:</span>
<span class="sd">            inputs: A sequence of tuples, where:</span>

<span class="sd">                - `JsonSchemaKeyT` will be paired with `JsonSchemaMode` to form the keys of the first returned</span>
<span class="sd">                    dictionary.</span>
<span class="sd">                - `JsonSchemaMode` is a JSON schema mode, either &#39;validation&#39; or &#39;serialization&#39;.</span>
<span class="sd">                - `core_schema.CoreSchema` is a Pydantic `core_schema`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A 2-tuple, where:</span>

<span class="sd">                - The first element is a dictionary whose keys are tuples of a JSON schema key type and mode, and</span>
<span class="sd">                    whose values are `DefsRef`.</span>
<span class="sd">                - The second element is a dictionary whose keys are `DefsRef` and whose values are `JsonSchemaValue`.</span>

<span class="sd">        Raises:</span>
<span class="sd">            PydanticUserError: Raised if the JSON schema generator has already been used to generate a JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_used</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PydanticUserError</span><span class="p">(</span>
                <span class="s1">&#39;This JSON schema generator has already been used to generate a JSON schema. &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;You must create a new instance of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> to generate a new JSON schema.&#39;</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s1">&#39;json-schema-already-used&#39;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">resolve_collisions</span><span class="p">({})</span>

        <span class="n">refs_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">JsonSchemaKeyT</span><span class="p">,</span> <span class="n">JsonSchemaMode</span><span class="p">],</span> <span class="n">DefsRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
            <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
                <span class="n">json_ref</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">])</span>
                <span class="n">defs_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">json_ref</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">defs_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="n">refs_map</span><span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="p">)]</span> <span class="o">=</span> <span class="n">defs_ref</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_used</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">refs_map</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>

    <span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchema</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">JsonSchemaMode</span> <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a JSON schema for a specified schema in a specified mode.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: A Pydantic model.</span>
<span class="sd">            mode: The mode in which to generate the schema. Defaults to &#39;validation&#39;.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A JSON schema representing the specified schema.</span>

<span class="sd">        Raises:</span>
<span class="sd">            PydanticUserError: If the JSON schema generator has already been used to generate a JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_used</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PydanticUserError</span><span class="p">(</span>
                <span class="s1">&#39;This JSON schema generator has already been used to generate a JSON schema. &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;You must create a new instance of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> to generate a new JSON schema.&#39;</span><span class="p">,</span>
                <span class="n">code</span><span class="o">=</span><span class="s1">&#39;json-schema-already-used&#39;</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
        <span class="n">json_ref_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_json_ref_counts</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

        <span class="c1"># Remove the top-level $ref if present; note that the _generate method already ensures there are no sibling keys</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;$ref&#39;</span><span class="p">))</span>
        <span class="k">while</span> <span class="n">ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># may need to unpack multiple levels</span>
            <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schema_from_definitions</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">json_ref_counts</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">ref_json_schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># Keep the ref, but use an allOf to remove the top level $ref</span>
                <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;allOf&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">ref</span><span class="p">}]}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># &quot;Unpack&quot; the ref since this is the only reference</span>
                <span class="n">json_schema</span> <span class="o">=</span> <span class="n">ref_json_schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># copy to prevent recursive dict reference</span>
                <span class="n">json_ref_counts</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
            <span class="n">ref</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;$ref&#39;</span><span class="p">))</span>

        <span class="c1"># Remove any definitions that, thanks to $ref-substitution, are no longer present.</span>
        <span class="c1"># I think this should only _possibly_ apply to the root model, though I&#39;m not 100% sure.</span>
        <span class="c1"># It might be safe to remove this logic, but I&#39;m keeping it for now</span>
        <span class="n">all_json_refs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_json_refs</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">json_ref_counts</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>

        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_collisions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$defs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>

        <span class="c1"># For now, we will not set the $schema key. However, if desired, this can be easily added by overriding</span>
        <span class="c1"># this method and adding the following line after a call to super().generate(schema):</span>
        <span class="c1"># json_schema[&#39;$schema&#39;] = self.schema_dialect</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_used</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">generate_inner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generates a JSON schema for a given `CoreSchemaOrField`.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (CoreSchemaOrField): The given `CoreSchemaOrField` to generate JSON schema for.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># If a schema with the same CoreRef has been handled, just return a reference to it</span>
        <span class="c1"># Note that this assumes that it will _never_ be the case that the same CoreRef is used</span>
        <span class="c1"># on types that should have different JSON schemas</span>
        <span class="k">if</span> <span class="s1">&#39;ref&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="n">core_ref</span> <span class="o">=</span> <span class="n">CoreRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore[typeddict-item]</span>
            <span class="n">core_mode_ref</span> <span class="o">=</span> <span class="p">(</span><span class="n">core_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">core_mode_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">:</span>
                <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]}</span>

        <span class="c1"># Generate the JSON schema, accounting for the json_schema_override and core_schema_override</span>
        <span class="n">metadata_handler</span> <span class="o">=</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">CoreMetadataHandler</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

        <span class="k">def</span> <span class="nf">handler_func</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Generate a JSON schema based on the input schema.</span>

<span class="sd">            Args:</span>
<span class="sd">                schema_or_field (CoreSchemaOrField): The schema data to generate a JSON schema from.</span>

<span class="sd">            Returns:</span>
<span class="sd">                JsonSchemaValue: The generated JSON schema.</span>

<span class="sd">            Raises:</span>
<span class="sd">                TypeError: If an unexpected schema type is encountered.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="c1"># Generate the core-schema-type-specific bits of the schema generation:</span>
            <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema_field</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">):</span>
                <span class="n">generate_for_schema_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type_to_method</span><span class="p">[</span><span class="n">schema_or_field</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span>
                <span class="n">json_schema</span> <span class="o">=</span> <span class="n">generate_for_schema_type</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected schema type: schema=</span><span class="si">{</span><span class="n">schema_or_field</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="c1"># Populate the definitions</span>
            <span class="k">if</span> <span class="s1">&#39;ref&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                <span class="n">core_ref</span> <span class="o">=</span> <span class="n">CoreRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore[typeddict-item]</span>
                <span class="n">defs_ref</span><span class="p">,</span> <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cache_defs_ref_schema</span><span class="p">(</span><span class="n">core_ref</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="n">defs_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_schema</span>
                <span class="n">json_schema</span> <span class="o">=</span> <span class="n">ref_json_schema</span>
            <span class="k">return</span> <span class="n">json_schema</span>

        <span class="n">current_handler</span> <span class="o">=</span> <span class="n">_schema_generation_shared</span><span class="o">.</span><span class="n">GenerateJsonSchemaHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler_func</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">js_modify_function</span> <span class="ow">in</span> <span class="n">metadata_handler</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pydantic_js_functions&#39;</span><span class="p">,</span> <span class="p">()):</span>

            <span class="k">def</span> <span class="nf">new_handler_func</span><span class="p">(</span>
                <span class="n">schema_or_field</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">,</span>
                <span class="n">current_handler</span><span class="p">:</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">GetJsonSchemaHandler</span> <span class="o">=</span> <span class="n">current_handler</span><span class="p">,</span>
                <span class="n">js_modify_function</span><span class="p">:</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">GetJsonSchemaFunction</span> <span class="o">=</span> <span class="n">js_modify_function</span><span class="p">,</span>
            <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">js_modify_function</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">,</span> <span class="n">current_handler</span><span class="p">)</span>

            <span class="n">current_handler</span> <span class="o">=</span> <span class="n">_schema_generation_shared</span><span class="o">.</span><span class="n">GenerateJsonSchemaHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_handler_func</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">current_handler</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="c1"># ### Schema generation methods</span>
    <span class="k">def</span> <span class="nf">any_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">AnySchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches any value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.AnySchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">none_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">NoneSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `None` value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.NoneSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">bool_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">BoolSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a Boolean value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.NoneSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">int_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">IntSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches an int value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.IntSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">numeric</span><span class="p">)</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">}}</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">float_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">FloatSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a Float value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.FloatSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;number&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">numeric</span><span class="p">)</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">}}</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">str_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">StringSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a string value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.StringSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">bytes_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">BytesSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a bytes value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.BytesSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;binary&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">bytes</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">date_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DateSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a date value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.DateSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">time_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TimeSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a time value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.TimeSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">datetime_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DatetimeSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `datetime` value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.DatetimeSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date-time&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">timedelta_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TimedeltaSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `timedelta` value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.TimedeltaSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;duration&#39;</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">literal_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">LiteralSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `Literal` value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema (core_schema.LiteralSchema): The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Enum</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;expected&#39;</span><span class="p">]]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="n">expected</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;enum&#39;</span><span class="p">:</span> <span class="n">expected</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">is_instance_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">IsInstanceSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that checks if a value is an instance of a class, equivalent to Python&#39;s `isinstance` method.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_invalid_for_json_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;core_schema.IsInstanceSchema (</span><span class="si">{</span><span class="n">schema</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">is_subclass_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">IsSubclassSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that checks if a value is a subtype of a class, equivalent to Python&#39;s `issubclass` method.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Note: This is for compatibility with V1; you can override if you want different behavior.</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="k">def</span> <span class="nf">callable_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">CallableSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that checks if a value is callable, equivalent to Python&#39;s `callable` method.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_invalid_for_json_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="s1">&#39;core_schema.CallableSchema&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">list_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ListSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `List` value.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items_schema</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="s1">&#39;items_schema&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items_schema</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">tuple_positional_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TuplePositionalSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a tuple of schemas.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">}</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;minItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
        <span class="n">prefixItems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">prefixItems</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;prefixItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefixItems</span>
        <span class="k">if</span> <span class="s1">&#39;extra_schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;extra_schema&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;maxItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">tuple_variable_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TupleVariableSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a tuple of a given schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># NOTE: The `items_schema` is always added, even when we explicitly create a</span>
        <span class="c1"># tuple variable schema without an `items_schema`.</span>
        <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">set_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">SetSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `Set` schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">frozenset_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">FrozenSetSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a `frozenset` schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_common_set_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">SetSchema</span> <span class="o">|</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">FrozenSetSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">items_schema</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="s1">&#39;items_schema&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;uniqueItems&#39;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items_schema</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">generator_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">GeneratorSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a JSON schema that represents the provided GeneratorSchema.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">items_schema</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="s1">&#39;items_schema&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items_schema</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">dict_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DictSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns a schema that matches a dict schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema: The schema.</span>

<span class="sd">        Returns:</span>
<span class="sd">            The generated JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">}</span>

        <span class="n">keys_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;keys_schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;keys_schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">keys_pattern</span> <span class="o">=</span> <span class="n">keys_schema</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pattern&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

        <span class="n">values_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;values_schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;values_schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="n">values_schema</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># don&#39;t give a title to the additionalProperties</span>
        <span class="k">if</span> <span class="n">values_schema</span> <span class="ow">or</span> <span class="n">keys_pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># don&#39;t add additionalProperties if it&#39;s empty</span>
            <span class="k">if</span> <span class="n">keys_pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;additionalProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_schema</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;patternProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">keys_pattern</span><span class="p">:</span> <span class="n">values_schema</span><span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">_function_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">schema</span><span class="p">:</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">AnyFunctionSchema</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_function_with_inner_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
            <span class="c1"># I&#39;m not sure if this might need to be different if the function&#39;s mode is &#39;before&#39;</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>
        <span class="c1"># function-plain</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_invalid_for_json_schema</span><span class="p">(</span>
            <span class="n">schema</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;core_schema.PlainValidatorFunctionSchema (</span><span class="si">{</span><span class="n">schema</span><span class="p">[</span><span class="s2">&quot;function&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">function_before_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">BeforeValidatorFunctionSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">function_after_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">AfterValidatorFunctionSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">function_plain_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">PlainValidatorFunctionSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">function_wrap_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">WrapValidatorFunctionSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_function_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">default_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">WithDefaultSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="s1">&#39;default&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span>
        <span class="k">elif</span> <span class="s1">&#39;default_factory&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="n">default</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;default_factory&#39;</span><span class="p">]()</span>
        <span class="k">else</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;`schema` has neither default nor default_factory&#39;</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="n">encoded_default</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">encode_default</span><span class="p">(</span><span class="n">default</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">pydantic_core</span><span class="o">.</span><span class="n">PydanticSerializationError</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">emit_warning</span><span class="p">(</span>
                <span class="s1">&#39;non-serializable-default&#39;</span><span class="p">,</span>
                <span class="sa">f</span><span class="s1">&#39;Default value </span><span class="si">{</span><span class="n">default</span><span class="si">}</span><span class="s1"> is not JSON serializable; excluding default from JSON schema&#39;</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="c1"># Return the inner schema, as though there was no default</span>
            <span class="k">return</span> <span class="n">json_schema</span>

        <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="c1"># Since reference schemas do not support child keys, we wrap the reference schema in a single-case allOf:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;allOf&#39;</span><span class="p">:</span> <span class="p">[</span><span class="n">json_schema</span><span class="p">],</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">encoded_default</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;default&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">encoded_default</span>
            <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">nullable_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">NullableSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">null_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">}</span>
        <span class="n">inner_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

        <span class="k">if</span> <span class="n">inner_json_schema</span> <span class="o">==</span> <span class="n">null_schema</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">null_schema</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Thanks to the equality check against `null_schema` above, I think &#39;oneOf&#39; would also be valid here;</span>
            <span class="c1"># I&#39;ll use &#39;anyOf&#39; for now, but it could be changed it if it would work better with some external tooling</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flattened_anyof</span><span class="p">([</span><span class="n">inner_json_schema</span><span class="p">,</span> <span class="n">null_schema</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">union_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">UnionSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">generated</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">JsonSchemaValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>

        <span class="n">choices</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">generated</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">s</span><span class="p">))</span>
            <span class="k">except</span> <span class="n">PydanticInvalidForJsonSchema</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">emit_warning</span><span class="p">(</span><span class="s1">&#39;skipped-choice&#39;</span><span class="p">,</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">generated</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">generated</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_flattened_anyof</span><span class="p">(</span><span class="n">generated</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">tagged_union_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TaggedUnionSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">generated</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="c1"># Use str(k) since keys must be strings for json; while not technically correct,</span>
                    <span class="c1"># it&#39;s the closest that can be represented in valid JSON</span>
                    <span class="n">generated</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">v</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="k">except</span> <span class="n">PydanticInvalidForJsonSchema</span> <span class="k">as</span> <span class="n">exc</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">emit_warning</span><span class="p">(</span><span class="s1">&#39;skipped-choice&#39;</span><span class="p">,</span> <span class="n">exc</span><span class="o">.</span><span class="n">message</span><span class="p">)</span>

        <span class="c1"># Populate the schema with any &quot;indirect&quot; references</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                <span class="k">while</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">],</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">int</span><span class="p">)):</span>
                    <span class="n">v</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;choices&#39;</span><span class="p">][</span><span class="n">v</span><span class="p">]</span>
                    <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="p">(</span><span class="nb">int</span><span class="p">,</span> <span class="nb">str</span><span class="p">))</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="n">generated</span><span class="p">:</span>
                    <span class="c1"># while it might seem unnecessary to check `if str(v) in generated`, a PydanticInvalidForJsonSchema</span>
                    <span class="c1"># may have been raised above, which would mean that the schema we want to reference won&#39;t be present</span>
                    <span class="n">generated</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">k</span><span class="p">)]</span> <span class="o">=</span> <span class="n">generated</span><span class="p">[</span><span class="nb">str</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>

        <span class="n">one_of_choices</span> <span class="o">=</span> <span class="n">_deduplicate_schemas</span><span class="p">(</span><span class="n">generated</span><span class="o">.</span><span class="n">values</span><span class="p">())</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;oneOf&#39;</span><span class="p">:</span> <span class="n">one_of_choices</span><span class="p">}</span>

        <span class="c1"># This reflects the v1 behavior; TODO: we should make it possible to exclude OpenAPI stuff from the JSON schema</span>
        <span class="n">openapi_discriminator</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_extract_discriminator</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">one_of_choices</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">openapi_discriminator</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s1">&#39;propertyName&#39;</span><span class="p">:</span> <span class="n">openapi_discriminator</span><span class="p">,</span>
                <span class="s1">&#39;mapping&#39;</span><span class="p">:</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;$ref&#39;</span><span class="p">,</span> <span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">generated</span><span class="o">.</span><span class="n">items</span><span class="p">()},</span>
            <span class="p">}</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">_extract_discriminator</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TaggedUnionSchema</span><span class="p">,</span> <span class="n">one_of_choices</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">_JsonDict</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Extract a compatible OpenAPI discriminator from the schema and one_of choices that end up in the final schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">openapi_discriminator</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="s1">&#39;discriminator&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">]</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span>
            <span class="c1"># If the discriminator is a single item list containing a string, that is equivalent to the string case</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">return</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="c1"># When an alias is used that is different from the field name, the discriminator will be a list of single</span>
            <span class="c1"># str lists, one for the attribute and one for the actual alias. The logic here will work even if there is</span>
            <span class="c1"># more than one possible attribute, and looks for whether a single alias choice is present as a documented</span>
            <span class="c1"># property on all choices. If so, that property will be used as the OpenAPI discriminator.</span>
            <span class="k">for</span> <span class="n">alias_path</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;discriminator&#39;</span><span class="p">]:</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias_path</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                    <span class="k">break</span>  <span class="c1"># this means that the discriminator is not a list of alias paths</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">alias_path</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="k">continue</span>  <span class="c1"># this means that the &quot;alias&quot; does not represent a single field</span>
                <span class="n">alias</span> <span class="o">=</span> <span class="n">alias_path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="k">continue</span>  <span class="c1"># this means that the &quot;alias&quot; does not represent a field</span>
                <span class="n">alias_is_present_on_all_choices</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">one_of_choices</span><span class="p">:</span>
                    <span class="k">while</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">choice</span><span class="p">:</span>
                        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">choice</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">],</span> <span class="nb">str</span><span class="p">)</span>
                        <span class="n">choice</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schema_from_definitions</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">(</span><span class="n">choice</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]))</span> <span class="ow">or</span> <span class="p">{}</span>
                    <span class="n">properties</span> <span class="o">=</span> <span class="n">choice</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;properties&#39;</span><span class="p">,</span> <span class="p">{})</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">properties</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)</span> <span class="ow">or</span> <span class="n">alias</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">properties</span><span class="p">:</span>
                        <span class="n">alias_is_present_on_all_choices</span> <span class="o">=</span> <span class="kc">False</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">alias_is_present_on_all_choices</span><span class="p">:</span>
                    <span class="n">openapi_discriminator</span> <span class="o">=</span> <span class="n">alias</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">openapi_discriminator</span>

    <span class="k">def</span> <span class="nf">chain_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ChainSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="c1"># Note: If we wanted to generate a schema for the _serialization_, would want to use the _last_ step:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;steps&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
        <span class="k">except</span> <span class="ne">IndexError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s1">&#39;Cannot generate a JsonSchema for a zero-step ChainSchema&#39;</span><span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>

    <span class="k">def</span> <span class="nf">lax_or_strict_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">LaxOrStrictSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        LaxOrStrict will use the strict branch for serialization internally,</span>
<span class="sd">        unless it was overridden here.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># TODO: Need to read the default value off of model config or whatever</span>
        <span class="n">use_strict</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># TODO: replace this default False</span>
        <span class="c1"># If your JSON schema fails to generate it is probably</span>
        <span class="c1"># because one of the following two branches failed.</span>
        <span class="k">if</span> <span class="n">use_strict</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;strict_schema&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;lax_schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">json_or_python_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">JsonOrPythonSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Always uses the json schema</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;json_schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">typed_dict_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TypedDictSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">named_required_fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">CoreSchemaField</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_is_required</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">field</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_is_present</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
            <span class="n">named_required_fields</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name_required_computed_fields</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;computed_fields&#39;</span><span class="p">,</span> <span class="p">[])))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_required_fields_schema</span><span class="p">(</span><span class="n">named_required_fields</span><span class="p">)</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">_name_required_computed_fields</span><span class="p">(</span>
        <span class="n">computed_fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">ComputedField</span><span class="p">],</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ComputedField</span><span class="p">]]:</span>
        <span class="k">return</span> <span class="p">[(</span><span class="n">field</span><span class="p">[</span><span class="s1">&#39;property_name&#39;</span><span class="p">],</span> <span class="kc">True</span><span class="p">,</span> <span class="n">field</span><span class="p">)</span> <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">computed_fields</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_named_required_fields_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">named_required_fields</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">CoreSchemaField</span><span class="p">]]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">properties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">required_fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">required</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">named_required_fields</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_alias</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_alias_name</span><span class="p">(</span><span class="n">field</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">field_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">field</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="k">except</span> <span class="n">PydanticOmit</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="s1">&#39;title&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">field_json_schema</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">field</span><span class="p">):</span>
                <span class="n">title</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_title_from_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">field_json_schema</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
            <span class="n">field_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_ref_overrides</span><span class="p">(</span><span class="n">field_json_schema</span><span class="p">)</span>
            <span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">field_json_schema</span>
            <span class="k">if</span> <span class="n">required</span><span class="p">:</span>
                <span class="n">required_fields</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="n">properties</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">required_fields</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">required_fields</span>  <span class="c1"># type: ignore</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">_get_alias_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">CoreSchemaField</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;computed-field&#39;</span><span class="p">:</span>
            <span class="n">alias</span><span class="p">:</span> <span class="n">Any</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alias&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;validation_alias&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serialization_alias&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">alias</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;list[str] | str&#39;</span><span class="p">,</span> <span class="n">alias</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">alias</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">path</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">str</span><span class="p">):</span>
                    <span class="c1"># Use the first valid single-item string path; the code that constructs the alias array</span>
                    <span class="c1"># should ensure the first such item is what belongs in the JSON schema</span>
                    <span class="n">name</span> <span class="o">=</span> <span class="n">path</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                    <span class="k">break</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">assert_never</span><span class="p">(</span><span class="n">alias</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">typed_dict_field_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TypedDictField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">dataclass_field_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DataclassField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">model_field_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ModelField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">computed_field_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ComputedField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;return_schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">model_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ModelSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="c1"># We do not use schema[&#39;model&#39;].model_json_schema() here</span>
        <span class="c1"># because it could lead to inconsistent refs handling, etc.</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

        <span class="bp">cls</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;type[BaseModel]&#39;</span><span class="p">,</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;cls&#39;</span><span class="p">])</span>
        <span class="n">config</span> <span class="o">=</span> <span class="bp">cls</span><span class="o">.</span><span class="n">model_config</span>
        <span class="n">title</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span>
        <span class="n">forbid_additional_properties</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extra&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;forbid&#39;</span>
        <span class="n">json_schema_extra</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;json_schema_extra&#39;</span><span class="p">)</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_class_schema</span><span class="p">(</span>
            <span class="n">json_schema</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">forbid_additional_properties</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">json_schema_extra</span>
        <span class="p">)</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">_update_class_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">,</span>
        <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">forbid_additional_properties</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
        <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">Any</span><span class="p">],</span>
        <span class="n">json_schema_extra</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">|</span> <span class="n">JsonSchemaExtraCallable</span> <span class="o">|</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="n">schema_to_update</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schema_from_definitions</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]))</span> <span class="ow">or</span> <span class="n">json_schema</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">schema_to_update</span> <span class="o">=</span> <span class="n">json_schema</span>

        <span class="k">if</span> <span class="n">title</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># referenced_schema[&#39;title&#39;] = title</span>
            <span class="n">schema_to_update</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="n">title</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">forbid_additional_properties</span><span class="p">:</span>
            <span class="n">schema_to_update</span><span class="p">[</span><span class="s1">&#39;additionalProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="p">,</span> <span class="p">(</span><span class="nb">staticmethod</span><span class="p">,</span> <span class="nb">classmethod</span><span class="p">)):</span>
            <span class="c1"># In older versions of python, this is necessary to ensure staticmethod/classmethods are callable</span>
            <span class="n">json_schema_extra</span> <span class="o">=</span> <span class="n">json_schema_extra</span><span class="o">.</span><span class="fm">__get__</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">schema_to_update</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">callable</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="n">json_schema_extra</span><span class="p">)</span><span class="o">.</span><span class="n">parameters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">json_schema_extra</span><span class="p">(</span><span class="n">schema_to_update</span><span class="p">,</span> <span class="bp">cls</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">json_schema_extra</span><span class="p">(</span><span class="n">schema_to_update</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">json_schema_extra</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;model_config[&#39;json_schema_extra&#39;]=</span><span class="si">{</span><span class="n">json_schema_extra</span><span class="si">}</span><span class="s2"> should be a dict, callable, or None&quot;</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">model_fields_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ModelFieldsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">named_required_fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">CoreSchemaField</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">name</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_is_required</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">field</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_is_present</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
            <span class="n">named_required_fields</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name_required_computed_fields</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;computed_fields&#39;</span><span class="p">,</span> <span class="p">[])))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_required_fields_schema</span><span class="p">(</span><span class="n">named_required_fields</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">field_is_present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">CoreSchemaField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the field should be included in the generated JSON schema</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
            <span class="c1"># If you still want to include the field in the generated JSON schema,</span>
            <span class="c1"># override this method and return True</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serialization_exclude&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">True</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">assert_never</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">field_is_required</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ModelField</span> <span class="o">|</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DataclassField</span> <span class="o">|</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TypedDictField</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Whether the field should be marked as required in the generated JSON schema.</span>
<span class="sd">        (Note that this is irrelevant if the field is not present in the JSON schema.)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serialization_exclude&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;typed-dict-field&#39;</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">]</span>  <span class="c1"># type: ignore  # required is always populated</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;default&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">assert_never</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dataclass_args_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DataclassArgsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">named_required_fields</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">CoreSchemaField</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[</span>
            <span class="p">(</span><span class="n">field</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_is_required</span><span class="p">(</span><span class="n">field</span><span class="p">),</span> <span class="n">field</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">field</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;fields&#39;</span><span class="p">]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_is_present</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
        <span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
            <span class="n">named_required_fields</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name_required_computed_fields</span><span class="p">(</span><span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;computed_fields&#39;</span><span class="p">,</span> <span class="p">[])))</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_named_required_fields_schema</span><span class="p">(</span><span class="n">named_required_fields</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">dataclass_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DataclassSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="bp">cls</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;cls&#39;</span><span class="p">]</span>
        <span class="n">config</span><span class="p">:</span> <span class="n">ConfigDict</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__pydantic_config__&#39;</span><span class="p">,</span> <span class="n">cast</span><span class="p">(</span><span class="s1">&#39;ConfigDict&#39;</span><span class="p">,</span> <span class="p">{}))</span>

        <span class="n">title</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span>
        <span class="n">forbid_additional_properties</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;extra&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;forbid&#39;</span>
        <span class="n">json_schema_extra</span> <span class="o">=</span> <span class="n">config</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;json_schema_extra&#39;</span><span class="p">)</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_update_class_schema</span><span class="p">(</span>
            <span class="n">json_schema</span><span class="p">,</span> <span class="n">title</span><span class="p">,</span> <span class="n">forbid_additional_properties</span><span class="p">,</span> <span class="bp">cls</span><span class="p">,</span> <span class="n">json_schema_extra</span>
        <span class="p">)</span>

        <span class="c1"># Dataclass-specific handling of description</span>
        <span class="k">if</span> <span class="n">is_dataclass</span><span class="p">(</span><span class="bp">cls</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="s1">&#39;__pydantic_validator__&#39;</span><span class="p">):</span>
            <span class="c1"># vanilla dataclass; don&#39;t use cls.__doc__ as it will contain the class signature by default</span>
            <span class="n">description</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="kc">None</span> <span class="k">if</span> <span class="bp">cls</span><span class="o">.</span><span class="vm">__doc__</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">inspect</span><span class="o">.</span><span class="n">cleandoc</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">arguments_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ArgumentsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">metadata</span> <span class="o">=</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">CoreMetadataHandler</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span><span class="o">.</span><span class="n">metadata</span>
        <span class="n">prefer_positional</span> <span class="o">=</span> <span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pydantic_js_prefer_positional_arguments&#39;</span><span class="p">)</span>

        <span class="n">arguments</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;arguments_schema&#39;</span><span class="p">]</span>
        <span class="n">kw_only_arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arguments</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;keyword_only&#39;</span><span class="p">]</span>
        <span class="n">kw_or_p_arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arguments</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">)</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;positional_or_keyword&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">}]</span>
        <span class="n">p_only_arguments</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span> <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="n">arguments</span> <span class="k">if</span> <span class="n">a</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;mode&#39;</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;positional_only&#39;</span><span class="p">]</span>
        <span class="n">var_args_schema</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;var_args_schema&#39;</span><span class="p">)</span>
        <span class="n">var_kwargs_schema</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;var_kwargs_schema&#39;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">prefer_positional</span><span class="p">:</span>
            <span class="n">positional_possible</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">kw_only_arguments</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var_kwargs_schema</span>
            <span class="k">if</span> <span class="n">positional_possible</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_arguments_schema</span><span class="p">(</span><span class="n">p_only_arguments</span> <span class="o">+</span> <span class="n">kw_or_p_arguments</span><span class="p">,</span> <span class="n">var_args_schema</span><span class="p">)</span>

        <span class="n">keyword_possible</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">p_only_arguments</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var_args_schema</span>
        <span class="k">if</span> <span class="n">keyword_possible</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">kw_arguments_schema</span><span class="p">(</span><span class="n">kw_or_p_arguments</span> <span class="o">+</span> <span class="n">kw_only_arguments</span><span class="p">,</span> <span class="n">var_kwargs_schema</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">prefer_positional</span><span class="p">:</span>
            <span class="n">positional_possible</span> <span class="o">=</span> <span class="ow">not</span> <span class="n">kw_only_arguments</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">var_kwargs_schema</span>
            <span class="k">if</span> <span class="n">positional_possible</span><span class="p">:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">p_arguments_schema</span><span class="p">(</span><span class="n">p_only_arguments</span> <span class="o">+</span> <span class="n">kw_or_p_arguments</span><span class="p">,</span> <span class="n">var_args_schema</span><span class="p">)</span>

        <span class="k">raise</span> <span class="n">PydanticInvalidForJsonSchema</span><span class="p">(</span>
            <span class="s1">&#39;Unable to generate JSON schema for arguments validator with positional-only and keyword-only arguments&#39;</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">kw_arguments_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">core_schema</span><span class="o">.</span><span class="n">ArgumentsParameter</span><span class="p">],</span> <span class="n">var_kwargs_schema</span><span class="p">:</span> <span class="n">CoreSchema</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">properties</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">required</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument_name</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>
            <span class="n">argument_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">argument</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">argument_schema</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_title_from_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">properties</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">argument_schema</span>

            <span class="k">if</span> <span class="n">argument</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="c1"># This assumes that if the argument has a default value,</span>
                <span class="c1"># the inner schema must be of type WithDefaultSchema.</span>
                <span class="c1"># I believe this is true, but I am not 100% sure</span>
                <span class="n">required</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>

        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">,</span> <span class="s1">&#39;properties&#39;</span><span class="p">:</span> <span class="n">properties</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">required</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">required</span>

        <span class="k">if</span> <span class="n">var_kwargs_schema</span><span class="p">:</span>
            <span class="n">additional_properties_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">var_kwargs_schema</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">additional_properties_schema</span><span class="p">:</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;additionalProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">additional_properties_schema</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;additionalProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">p_arguments_schema</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">arguments</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">core_schema</span><span class="o">.</span><span class="n">ArgumentsParameter</span><span class="p">],</span> <span class="n">var_args_schema</span><span class="p">:</span> <span class="n">CoreSchema</span> <span class="o">|</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">prefix_items</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">JsonSchemaValue</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">min_items</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="k">for</span> <span class="n">argument</span> <span class="ow">in</span> <span class="n">arguments</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_argument_name</span><span class="p">(</span><span class="n">argument</span><span class="p">)</span>

            <span class="n">argument_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">argument</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
            <span class="n">argument_schema</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_title_from_name</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
            <span class="n">prefix_items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">argument_schema</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">argument</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;default&#39;</span><span class="p">:</span>
                <span class="c1"># This assumes that if the argument has a default value,</span>
                <span class="c1"># the inner schema must be of type WithDefaultSchema.</span>
                <span class="c1"># I believe this is true, but I am not 100% sure</span>
                <span class="n">min_items</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;prefixItems&#39;</span><span class="p">:</span> <span class="n">prefix_items</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">min_items</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;minItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">min_items</span>

        <span class="k">if</span> <span class="n">var_args_schema</span><span class="p">:</span>
            <span class="n">items_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">var_args_schema</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">items_schema</span><span class="p">:</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">items_schema</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;maxItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">prefix_items</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">get_argument_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">argument</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ArgumentsParameter</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">name</span> <span class="o">=</span> <span class="n">argument</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">by_alias</span><span class="p">:</span>
            <span class="n">alias</span> <span class="o">=</span> <span class="n">argument</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;alias&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">alias</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">name</span> <span class="o">=</span> <span class="n">alias</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>  <span class="c1"># might want to do something else?</span>
        <span class="k">return</span> <span class="n">name</span>

    <span class="k">def</span> <span class="nf">call_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">CallSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;arguments_schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">custom_error_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">CustomErrorSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">json_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">JsonSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;json-string&#39;</span><span class="p">}</span>
        <span class="k">elif</span> <span class="s1">&#39;schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># No wrapped schema, so return the same thing we would for an Any schema</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">core_schema</span><span class="o">.</span><span class="n">any_schema</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">url_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">UrlSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;uri&#39;</span><span class="p">,</span> <span class="s1">&#39;minLength&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">multi_host_url_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">MultiHostUrlSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="c1"># Note: &#39;multi-host-uri&#39; is a custom/pydantic-specific format, not part of the JSON Schema spec</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;multi-host-uri&#39;</span><span class="p">,</span> <span class="s1">&#39;minLength&#39;</span><span class="p">:</span> <span class="mi">1</span><span class="p">}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">definitions_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DefinitionsSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">definition</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;definitions&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">definition</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">definition_ref_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DefinitionReferenceSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">core_ref</span> <span class="o">=</span> <span class="n">CoreRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema_ref&#39;</span><span class="p">])</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cache_defs_ref_schema</span><span class="p">(</span><span class="n">core_ref</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ref_json_schema</span>

    <span class="c1"># ### Utility methods</span>

    <span class="k">def</span> <span class="nf">get_title_from_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">name</span><span class="o">.</span><span class="n">title</span><span class="p">()</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="s1">&#39; &#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">field_title_should_be_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns true if a field with the given schema should have a title set based on the field name.</span>

<span class="sd">        Intuitively, we want this to return true for schemas that wouldn&#39;t otherwise provide their own title</span>
<span class="sd">        (e.g., int, float, str), and false for those that would (e.g., BaseModel subclasses).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema_field</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;computed-field&#39;</span><span class="p">:</span>
                <span class="n">field_schema</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;return_schema&#39;</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">field_schema</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">]</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">field_schema</span><span class="p">)</span>

        <span class="k">elif</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ref&#39;</span><span class="p">):</span>  <span class="c1"># things with refs, such as models and enums, should not have titles set</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;nullable&#39;</span><span class="p">,</span> <span class="s1">&#39;definitions&#39;</span><span class="p">}:</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore[typeddict-item]</span>
            <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_function_with_inner_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
                <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;definition-ref&#39;</span><span class="p">:</span>
                <span class="c1"># Referenced schemas should not have titles set for the same reason</span>
                <span class="c1"># schemas with refs should not</span>
                <span class="k">return</span> <span class="kc">False</span>
            <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># anything else should have title set</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">PydanticInvalidForJsonSchema</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected schema type: schema=</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">normalize_name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;[^a-zA-Z0-9.\-_]&#39;</span><span class="p">,</span> <span class="s1">&#39;_&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">,</span> <span class="s1">&#39;__&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_defs_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core_mode_ref</span><span class="p">:</span> <span class="n">CoreModeRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DefsRef</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Override this method to change the way that definitions keys are generated from a core reference.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Split the core ref into &quot;components&quot;; generic origins and arguments are each separate components</span>
        <span class="n">core_ref</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">core_mode_ref</span>
        <span class="n">components</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([\][,])&#39;</span><span class="p">,</span> <span class="n">core_ref</span><span class="p">)</span>
        <span class="c1"># Remove IDs from each component</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>
        <span class="n">core_ref_no_id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
        <span class="c1"># Remove everything before the last period from each &quot;component&quot;</span>
        <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?:[^.[\]]+\.)+((?:[^.[\]]+))&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>
        <span class="n">short_ref</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>

        <span class="n">mode_title</span> <span class="o">=</span> <span class="n">_MODE_TITLE_MAPPING</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span>
        <span class="c1"># It is important that the generated defs_ref values be such that at least one could not</span>
        <span class="c1"># be generated for any other core_ref. Currently, this should be the case because we include</span>
        <span class="c1"># the id of the source type in the core_ref</span>
        <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span>
            <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">short_ref</span><span class="p">)),</span>  <span class="c1"># name</span>
            <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">short_ref</span> <span class="o">+</span> <span class="n">mode_title</span><span class="p">)),</span>  <span class="c1"># name + mode</span>
            <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref_no_id</span><span class="p">)),</span>  <span class="c1"># module + qualname</span>
            <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref_no_id</span> <span class="o">+</span> <span class="n">mode_title</span><span class="p">)),</span>  <span class="c1"># module + qualname + mode</span>
            <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref</span><span class="p">)),</span>  <span class="c1"># module + qualname + id</span>
            <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref</span> <span class="o">+</span> <span class="n">mode_title</span><span class="p">)),</span>  <span class="c1"># module + qualname + id + mode</span>
        <span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">defs_ref_fallbacks</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">choices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">core_mode_ref</span><span class="p">)</span> <span class="o">==</span> <span class="n">core_mode_ref</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">choice</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">choices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># should never get here if the final choice is guaranteed unique</span>

    <span class="k">def</span> <span class="nf">resolve_collisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This function ensures that any defs_ref&#39;s that were involved in collisions</span>
<span class="sd">        (due to simplification of the core_ref) get updated, even if they were the</span>
<span class="sd">        first occurrence of the colliding defs_ref.</span>

<span class="sd">        This is intended to prevent confusion where the type that gets the &quot;shortened&quot;</span>
<span class="sd">        ref depends on the order in which the types were visited.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">made_changes</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="c1"># Note that because the defs ref choices eventually produce values that use the IDs and</span>
        <span class="c1"># should _never_ collide, it should not be possible for this while loop to run forever</span>
        <span class="k">while</span> <span class="n">made_changes</span><span class="p">:</span>
            <span class="n">made_changes</span> <span class="o">=</span> <span class="kc">False</span>

            <span class="k">for</span> <span class="n">defs_ref</span><span class="p">,</span> <span class="n">core_mode_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">defs_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_ref_fallbacks</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]:</span>
                    <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="n">defs_ref</span> <span class="ow">or</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="p">:</span>
                        <span class="k">continue</span>

                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">core_mode_ref</span><span class="p">)</span> <span class="o">==</span> <span class="n">core_mode_ref</span><span class="p">:</span>
                        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_defs_ref</span><span class="p">(</span><span class="n">defs_ref</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">)</span>
                        <span class="n">made_changes</span> <span class="o">=</span> <span class="kc">True</span>
                        <span class="k">break</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

                <span class="k">if</span> <span class="n">made_changes</span><span class="p">:</span>
                    <span class="k">break</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">change_defs_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">old</span><span class="p">:</span> <span class="n">DefsRef</span><span class="p">,</span> <span class="n">new</span><span class="p">:</span> <span class="n">DefsRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">new</span> <span class="o">==</span> <span class="n">old</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">json_schema</span>
        <span class="n">core_mode_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="p">[</span><span class="n">old</span><span class="p">]</span>
        <span class="n">old_json_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span>
        <span class="n">new_json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">new</span><span class="p">))</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="n">new</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="p">[</span><span class="n">new</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old</span><span class="p">)</span>
        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">old_json_ref</span><span class="p">)</span> <span class="o">==</span> <span class="n">old</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">new_json_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">new</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_json_ref</span>

        <span class="k">def</span> <span class="nf">walk_replace_json_schema_ref</span><span class="p">(</span><span class="n">item</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Recursively update the JSON schema to use the new defs_ref.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">return</span> <span class="p">[</span><span class="n">walk_replace_json_schema_ref</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">item</span><span class="p">]</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="n">ref</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;$ref&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">ref</span> <span class="o">==</span> <span class="n">old_json_ref</span><span class="p">:</span>
                    <span class="n">item</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_json_ref</span>
                <span class="k">return</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">walk_replace_json_schema_ref</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">item</span><span class="o">.</span><span class="n">items</span><span class="p">()}</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="n">item</span>

        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">walk_replace_json_schema_ref</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">walk_replace_json_schema_ref</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">get_cache_defs_ref_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core_ref</span><span class="p">:</span> <span class="n">CoreRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method wraps the get_defs_ref method with some cache-lookup/population logic,</span>
<span class="sd">        and returns both the produced defs_ref and the JSON schema that will refer to the right definition.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">core_mode_ref</span> <span class="o">=</span> <span class="p">(</span><span class="n">core_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
        <span class="n">maybe_defs_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">core_mode_ref</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">maybe_defs_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span>
            <span class="k">return</span> <span class="n">maybe_defs_ref</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_ref</span><span class="p">}</span>

        <span class="n">defs_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defs_ref</span><span class="p">(</span><span class="n">core_mode_ref</span><span class="p">)</span>

        <span class="c1"># populate the ref translation mappings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">defs_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="p">[</span><span class="n">defs_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">core_mode_ref</span>

        <span class="n">json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">defs_ref</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_ref</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">defs_ref</span>
        <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_ref</span><span class="p">}</span>
        <span class="k">return</span> <span class="n">defs_ref</span><span class="p">,</span> <span class="n">ref_json_schema</span>

    <span class="k">def</span> <span class="nf">handle_ref_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        It is not valid for a schema with a top-level $ref to have sibling keys.</span>

<span class="sd">        During our own schema generation, we treat sibling keys as overrides to the referenced schema,</span>
<span class="sd">        but this is not how the official JSON schema spec works.</span>

<span class="sd">        Because of this, we first remove any sibling keys that are redundant with the referenced schema, then if</span>
<span class="sd">        any remain, we transform the schema from a top-level &#39;$ref&#39; to use allOf to move the $ref out of the top level.</span>
<span class="sd">        (See bottom of https://swagger.io/docs/specification/using-ref/ for a reference about this behavior)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="c1"># prevent modifications to the input; this copy may be safe to drop if there is significant overhead</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

            <span class="n">referenced_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schema_from_definitions</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]))</span>
            <span class="k">if</span> <span class="n">referenced_json_schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># This can happen when building schemas for models with not-yet-defined references.</span>
                <span class="c1"># It may be a good idea to do a recursive pass at the end of the generation to remove</span>
                <span class="c1"># any redundant override keys.</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="c1"># Make it an allOf to at least resolve the sibling keys issue</span>
                    <span class="n">json_schema</span> <span class="o">=</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                    <span class="n">json_schema</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;allOf&#39;</span><span class="p">,</span> <span class="p">[])</span>
                    <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;allOf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]})</span>
                    <span class="k">del</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]</span>

                <span class="k">return</span> <span class="n">json_schema</span>
            <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">json_schema</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
                <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;$ref&#39;</span><span class="p">:</span>
                    <span class="k">continue</span>
                <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">referenced_json_schema</span> <span class="ow">and</span> <span class="n">referenced_json_schema</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
                    <span class="k">del</span> <span class="n">json_schema</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>  <span class="c1"># redundant key</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># There is a remaining &quot;override&quot; key, so we need to move $ref out of the top level</span>
                <span class="n">json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">])</span>
                <span class="k">del</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]</span>
                <span class="k">assert</span> <span class="s1">&#39;allOf&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span>  <span class="c1"># this should never happen, but just in case</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;allOf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_ref</span><span class="p">}]</span>

        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="k">def</span> <span class="nf">get_schema_from_definitions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_ref</span><span class="p">:</span> <span class="n">JsonRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">])</span>

    <span class="k">def</span> <span class="nf">encode_default</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dft</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Any</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">pydantic_core</span><span class="o">.</span><span class="n">to_jsonable_python</span><span class="p">(</span><span class="n">dft</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">update_with_validations</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">,</span> <span class="n">core_schema</span><span class="p">:</span> <span class="n">CoreSchema</span><span class="p">,</span> <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update the json_schema with the corresponding validations specified in the core_schema,</span>
<span class="sd">        using the provided mapping to translate keys in core_schema to the appropriate keys for a JSON schema.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">for</span> <span class="n">core_key</span><span class="p">,</span> <span class="n">json_schema_key</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">core_key</span> <span class="ow">in</span> <span class="n">core_schema</span><span class="p">:</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="n">json_schema_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">core_schema</span><span class="p">[</span><span class="n">core_key</span><span class="p">]</span>  <span class="c1"># type: ignore[literal-required]</span>

    <span class="k">class</span> <span class="nc">ValidationsMapping</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This class just contains mappings from core_schema attribute names to the corresponding</span>
<span class="sd">        JSON schema attribute names. While I suspect it is unlikely to be necessary, you can in</span>
<span class="sd">        principle override this class in a subclass of GenerateJsonSchema (by inheriting from</span>
<span class="sd">        GenerateJsonSchema.ValidationsMapping) to change these mappings.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">numeric</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;multiple_of&#39;</span><span class="p">:</span> <span class="s1">&#39;multipleOf&#39;</span><span class="p">,</span>
            <span class="s1">&#39;le&#39;</span><span class="p">:</span> <span class="s1">&#39;maximum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ge&#39;</span><span class="p">:</span> <span class="s1">&#39;minimum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;lt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMaximum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;gt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMinimum&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="nb">bytes</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minLength&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxLength&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">string</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minLength&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxLength&#39;</span><span class="p">,</span>
            <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;pattern&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">array</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minItems&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxItems&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="nb">object</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minProperties&#39;</span><span class="p">,</span>
            <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxProperties&#39;</span><span class="p">,</span>
        <span class="p">}</span>
        <span class="n">date</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s1">&#39;le&#39;</span><span class="p">:</span> <span class="s1">&#39;maximum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;ge&#39;</span><span class="p">:</span> <span class="s1">&#39;minimum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;lt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMaximum&#39;</span><span class="p">,</span>
            <span class="s1">&#39;gt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMinimum&#39;</span><span class="p">,</span>
        <span class="p">}</span>

    <span class="k">def</span> <span class="nf">get_flattened_anyof</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schemas</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">JsonSchemaValue</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">schemas</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="s1">&#39;anyOf&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                <span class="n">members</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;anyOf&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
        <span class="n">members</span> <span class="o">=</span> <span class="n">_deduplicate_schemas</span><span class="p">(</span><span class="n">members</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">members</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">members</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;anyOf&#39;</span><span class="p">:</span> <span class="n">members</span><span class="p">}</span>

    <span class="k">def</span> <span class="nf">get_json_ref_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">JsonRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get all values corresponding to the key &#39;$ref&#39; anywhere in the json_schema</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">json_refs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">JsonRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>

        <span class="k">def</span> <span class="nf">_add_json_refs</span><span class="p">(</span><span class="n">schema</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                    <span class="n">json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">])</span>
                    <span class="n">already_visited</span> <span class="o">=</span> <span class="n">json_ref</span> <span class="ow">in</span> <span class="n">json_refs</span>
                    <span class="n">json_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                    <span class="k">if</span> <span class="n">already_visited</span><span class="p">:</span>
                        <span class="k">return</span>  <span class="c1"># prevent recursion on a definition that was already visited</span>
                    <span class="n">_add_json_refs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">]])</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                    <span class="n">_add_json_refs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                    <span class="n">_add_json_refs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

        <span class="n">_add_json_refs</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">json_refs</span>

    <span class="k">def</span> <span class="nf">handle_invalid_for_json_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">,</span> <span class="n">error_info</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PydanticInvalidForJsonSchema</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Cannot generate a JsonSchema for </span><span class="si">{</span><span class="n">error_info</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">emit_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="n">JsonSchemaWarningKind</span><span class="p">,</span> <span class="n">detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method simply emits PydanticJsonSchemaWarnings based on handling in the `warning_message` method.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_warning_message</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">PydanticJsonSchemaWarning</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">render_warning_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="n">JsonSchemaWarningKind</span><span class="p">,</span> <span class="n">detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        This method is responsible for ignoring warnings as desired, and for formatting the warning messages.</span>

<span class="sd">        You can override the value of `ignored_warning_kinds` in a subclass of GenerateJsonSchema</span>
<span class="sd">        to modify what warnings are generated. If you want more control, you can override this method;</span>
<span class="sd">        just return None in situations where you don&#39;t want warnings to be emitted.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignored_warning_kinds</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">detail</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s1">]&#39;</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">








<div class="doc doc-object doc-class">



<h3 id="pydantic.json_schema.GenerateJsonSchema.ValidationsMapping" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">ValidationsMapping</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.ValidationsMapping" class="headerlink" title="Permanent link">&para;</a></h3>


  <div class="doc doc-contents ">

  
      <p>This class just contains mappings from core_schema attribute names to the corresponding
JSON schema attribute names. While I suspect it is unlikely to be necessary, you can in
principle override this class in a subclass of GenerateJsonSchema (by inheriting from
GenerateJsonSchema.ValidationsMapping) to change these mappings.</p>


        <details class="quote">
          <summary>Source code in <code>pydantic/json_schema.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ValidationsMapping</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class just contains mappings from core_schema attribute names to the corresponding</span>
<span class="sd">    JSON schema attribute names. While I suspect it is unlikely to be necessary, you can in</span>
<span class="sd">    principle override this class in a subclass of GenerateJsonSchema (by inheriting from</span>
<span class="sd">    GenerateJsonSchema.ValidationsMapping) to change these mappings.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">numeric</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;multiple_of&#39;</span><span class="p">:</span> <span class="s1">&#39;multipleOf&#39;</span><span class="p">,</span>
        <span class="s1">&#39;le&#39;</span><span class="p">:</span> <span class="s1">&#39;maximum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ge&#39;</span><span class="p">:</span> <span class="s1">&#39;minimum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMaximum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMinimum&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nb">bytes</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minLength&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxLength&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">string</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minLength&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxLength&#39;</span><span class="p">,</span>
        <span class="s1">&#39;pattern&#39;</span><span class="p">:</span> <span class="s1">&#39;pattern&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">array</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minItems&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxItems&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="nb">object</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;min_length&#39;</span><span class="p">:</span> <span class="s1">&#39;minProperties&#39;</span><span class="p">,</span>
        <span class="s1">&#39;max_length&#39;</span><span class="p">:</span> <span class="s1">&#39;maxProperties&#39;</span><span class="p">,</span>
    <span class="p">}</span>
    <span class="n">date</span> <span class="o">=</span> <span class="p">{</span>
        <span class="s1">&#39;le&#39;</span><span class="p">:</span> <span class="s1">&#39;maximum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;ge&#39;</span><span class="p">:</span> <span class="s1">&#39;minimum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;lt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMaximum&#39;</span><span class="p">,</span>
        <span class="s1">&#39;gt&#39;</span><span class="p">:</span> <span class="s1">&#39;exclusiveMinimum&#39;</span><span class="p">,</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
        </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div>


<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.any_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">any_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.any_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">any_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches any value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.AnySchema">AnySchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">any_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">AnySchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches any value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.AnySchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.bool_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">bool_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.bool_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">bool_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a Boolean value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.NoneSchema">NoneSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bool_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">BoolSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a Boolean value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.NoneSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;boolean&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.build_schema_type_to_method" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">build_schema_type_to_method</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.build_schema_type_to_method" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">build_schema_type_to_method</span><span class="p">()</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Builds a dictionary mapping <code>CoreSchemaOrFieldType</code> to a callable method that generates a <code>JsonSchema</code> value
for a given <code>CoreSchemaOrField</code>.</p>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>dict</code></td>          <td>
                <code>dict[<a class="autorefs autorefs-internal" title="pydantic.json_schema.CoreSchemaOrFieldType" href="#pydantic.json_schema.CoreSchemaOrFieldType">CoreSchemaOrFieldType</a>, <span title="typing.Callable">Callable</span>[[<span title="pydantic._internal._core_utils.CoreSchemaOrField">CoreSchemaOrField</span>], <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a>]]</code>
          </td>
          <td><p>A dictionary containing the mapping of <code>CoreSchemaOrFieldType</code> to a callable method.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>TypeError</code>
          </td>
          <td><p>If no method has been defined for generating a JSON schema for a given pydantic core schema type.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">build_schema_type_to_method</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreSchemaOrFieldType</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoreSchemaOrField</span><span class="p">],</span> <span class="n">JsonSchemaValue</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Builds a dictionary mapping `CoreSchemaOrFieldType` to a callable method that generates a `JsonSchema` value</span>
<span class="sd">    for a given `CoreSchemaOrField`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: A dictionary containing the mapping of `CoreSchemaOrFieldType` to a callable method.</span>

<span class="sd">    Raises:</span>
<span class="sd">        TypeError: If no method has been defined for generating a JSON schema for a given pydantic core schema type.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">CoreSchemaOrFieldType</span><span class="p">,</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">CoreSchemaOrField</span><span class="p">],</span> <span class="n">JsonSchemaValue</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">core_schema_types</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">CoreSchemaOrFieldType</span><span class="p">]</span> <span class="o">=</span> <span class="n">_typing_extra</span><span class="o">.</span><span class="n">all_literal_values</span><span class="p">(</span>
        <span class="n">CoreSchemaOrFieldType</span>  <span class="c1"># type: ignore</span>
    <span class="p">)</span>
    <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">core_schema_types</span><span class="p">:</span>
        <span class="n">method_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">key</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;_&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">_schema&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">mapping</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">method_name</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">AttributeError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>  <span class="c1"># pragma: no cover</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s1">&#39;No method for generating JsonSchema for core_schema.type=</span><span class="si">{</span><span class="n">key</span><span class="si">!r}</span><span class="s1"> &#39;</span>
                <span class="sa">f</span><span class="s1">&#39;(expected: </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">.</span><span class="si">{</span><span class="n">method_name</span><span class="si">}</span><span class="s1">)&#39;</span>
            <span class="p">)</span> <span class="kn">from</span> <span class="nn">e</span>
    <span class="k">return</span> <span class="n">mapping</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.bytes_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">bytes_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.bytes_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">bytes_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a bytes value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.BytesSchema">BytesSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bytes_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">BytesSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a bytes value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.BytesSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;binary&#39;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">bytes</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.callable_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">callable_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.callable_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">callable_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that checks if a value is callable, equivalent to Python's <code>callable</code> method.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.CallableSchema">CallableSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">callable_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">CallableSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that checks if a value is callable, equivalent to Python&#39;s `callable` method.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_invalid_for_json_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="s1">&#39;core_schema.CallableSchema&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.date_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">date_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.date_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">date_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a date value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.DateSchema">DateSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">date_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DateSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a date value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.DateSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date&#39;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">date</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.datetime_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">datetime_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.datetime_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">datetime_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>datetime</code> value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.DatetimeSchema">DatetimeSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">datetime_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DatetimeSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `datetime` value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.DatetimeSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;date-time&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.dict_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">dict_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.dict_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">dict_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a dict schema.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.DictSchema">DictSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span>
<span class="normal">704</span>
<span class="normal">705</span>
<span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">dict_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DictSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a dict schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;object&#39;</span><span class="p">}</span>

    <span class="n">keys_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;keys_schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;keys_schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="n">keys_pattern</span> <span class="o">=</span> <span class="n">keys_schema</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;pattern&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>

    <span class="n">values_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;values_schema&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span> <span class="k">if</span> <span class="s1">&#39;values_schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="n">values_schema</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="s1">&#39;title&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  <span class="c1"># don&#39;t give a title to the additionalProperties</span>
    <span class="k">if</span> <span class="n">values_schema</span> <span class="ow">or</span> <span class="n">keys_pattern</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># don&#39;t add additionalProperties if it&#39;s empty</span>
        <span class="k">if</span> <span class="n">keys_pattern</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;additionalProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">values_schema</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;patternProperties&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="n">keys_pattern</span><span class="p">:</span> <span class="n">values_schema</span><span class="p">}</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">object</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.emit_warning" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">emit_warning</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.emit_warning" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">emit_warning</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This method simply emits PydanticJsonSchemaWarnings based on handling in the <code>warning_message</code> method.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">emit_warning</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="n">JsonSchemaWarningKind</span><span class="p">,</span> <span class="n">detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method simply emits PydanticJsonSchemaWarnings based on handling in the `warning_message` method.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">message</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">render_warning_message</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">message</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="n">message</span><span class="p">,</span> <span class="n">PydanticJsonSchemaWarning</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.field_is_present" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">field_is_present</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.field_is_present" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">field_is_present</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Whether the field should be included in the generated JSON schema</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">field_is_present</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">CoreSchemaField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Whether the field should be included in the generated JSON schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
        <span class="c1"># If you still want to include the field in the generated JSON schema,</span>
        <span class="c1"># override this method and return True</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serialization_exclude&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">assert_never</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.field_is_required" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">field_is_required</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.field_is_required" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">field_is_required</span><span class="p">(</span><span class="n">field</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Whether the field should be marked as required in the generated JSON schema.
(Note that this is irrelevant if the field is not present in the JSON schema.)</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span>
<span class="normal">1047</span>
<span class="normal">1048</span>
<span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">field_is_required</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">field</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ModelField</span> <span class="o">|</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">DataclassField</span> <span class="o">|</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TypedDictField</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Whether the field should be marked as required in the generated JSON schema.</span>
<span class="sd">    (Note that this is irrelevant if the field is not present in the JSON schema.)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;serialization&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="ow">not</span> <span class="n">field</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;serialization_exclude&#39;</span><span class="p">)</span>
    <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">==</span> <span class="s1">&#39;validation&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;typed-dict-field&#39;</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;required&#39;</span><span class="p">]</span>  <span class="c1"># type: ignore  # required is always populated</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">field</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">][</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">!=</span> <span class="s1">&#39;default&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">assert_never</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.field_title_should_be_set" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">field_title_should_be_set</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.field_title_should_be_set" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns true if a field with the given schema should have a title set based on the field name.</p>
<p>Intuitively, we want this to return true for schemas that wouldn't otherwise provide their own title
(e.g., int, float, str), and false for those that would (e.g., BaseModel subclasses).</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">field_title_should_be_set</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns true if a field with the given schema should have a title set based on the field name.</span>

<span class="sd">    Intuitively, we want this to return true for schemas that wouldn&#39;t otherwise provide their own title</span>
<span class="sd">    (e.g., int, float, str), and false for those that would (e.g., BaseModel subclasses).</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema_field</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;computed-field&#39;</span><span class="p">:</span>
            <span class="n">field_schema</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;return_schema&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">field_schema</span> <span class="o">=</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">]</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">field_schema</span><span class="p">)</span>

    <span class="k">elif</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;ref&#39;</span><span class="p">):</span>  <span class="c1"># things with refs, such as models and enums, should not have titles set</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">,</span> <span class="s1">&#39;nullable&#39;</span><span class="p">,</span> <span class="s1">&#39;definitions&#39;</span><span class="p">}:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore[typeddict-item]</span>
        <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_function_with_inner_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">field_title_should_be_set</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;schema&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;definition-ref&#39;</span><span class="p">:</span>
            <span class="c1"># Referenced schemas should not have titles set for the same reason</span>
            <span class="c1"># schemas with refs should not</span>
            <span class="k">return</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="kc">True</span>  <span class="c1"># anything else should have title set</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PydanticInvalidForJsonSchema</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected schema type: schema=</span><span class="si">{</span><span class="n">schema</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.float_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">float_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.float_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">float_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a Float value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.FloatSchema">FloatSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">float_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">FloatSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a Float value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.FloatSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;number&#39;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">numeric</span><span class="p">)</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">}}</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.frozenset_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">frozenset_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.frozenset_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">frozenset_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>frozenset</code> schema.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.FrozenSetSchema">FrozenSetSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">frozenset_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">FrozenSetSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `frozenset` schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.generate" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">generate</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.generate" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">generate</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;validation&#39;</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Generates a JSON schema for a specified schema in a specified mode.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><span title="pydantic_core.CoreSchema">CoreSchema</span></code>
          </td>
          <td><p>A Pydantic model.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>mode</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaMode" href="#pydantic.json_schema.JsonSchemaMode">JsonSchemaMode</a></code>
          </td>
          <td><p>The mode in which to generate the schema. Defaults to 'validation'.</p></td>
          <td>
                <code>&#39;validation&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>A JSON schema representing the specified schema.</p></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.errors.PydanticUserError" href="../errors/#pydantic.errors.PydanticUserError">PydanticUserError</a></code>
          </td>
          <td><p>If the JSON schema generator has already been used to generate a JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchema</span><span class="p">,</span> <span class="n">mode</span><span class="p">:</span> <span class="n">JsonSchemaMode</span> <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a JSON schema for a specified schema in a specified mode.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: A Pydantic model.</span>
<span class="sd">        mode: The mode in which to generate the schema. Defaults to &#39;validation&#39;.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A JSON schema representing the specified schema.</span>

<span class="sd">    Raises:</span>
<span class="sd">        PydanticUserError: If the JSON schema generator has already been used to generate a JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_used</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PydanticUserError</span><span class="p">(</span>
            <span class="s1">&#39;This JSON schema generator has already been used to generate a JSON schema. &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;You must create a new instance of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> to generate a new JSON schema.&#39;</span><span class="p">,</span>
            <span class="n">code</span><span class="o">=</span><span class="s1">&#39;json-schema-already-used&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
    <span class="n">json_ref_counts</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_json_ref_counts</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>

    <span class="c1"># Remove the top-level $ref if present; note that the _generate method already ensures there are no sibling keys</span>
    <span class="n">ref</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;$ref&#39;</span><span class="p">))</span>
    <span class="k">while</span> <span class="n">ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>  <span class="c1"># may need to unpack multiple levels</span>
        <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schema_from_definitions</span><span class="p">(</span><span class="n">ref</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">json_ref_counts</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="ow">or</span> <span class="n">ref_json_schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># Keep the ref, but use an allOf to remove the top level $ref</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;allOf&#39;</span><span class="p">:</span> <span class="p">[{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">ref</span><span class="p">}]}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># &quot;Unpack&quot; the ref since this is the only reference</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="n">ref_json_schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>  <span class="c1"># copy to prevent recursive dict reference</span>
            <span class="n">json_ref_counts</span><span class="p">[</span><span class="n">ref</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>
        <span class="n">ref</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;$ref&#39;</span><span class="p">))</span>

    <span class="c1"># Remove any definitions that, thanks to $ref-substitution, are no longer present.</span>
    <span class="c1"># I think this should only _possibly_ apply to the root model, though I&#39;m not 100% sure.</span>
    <span class="c1"># It might be safe to remove this logic, but I&#39;m keeping it for now</span>
    <span class="n">all_json_refs</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">all_json_refs</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">json_ref_counts</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">del</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">k</span><span class="p">]]</span>

    <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">resolve_collisions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$defs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>

    <span class="c1"># For now, we will not set the $schema key. However, if desired, this can be easily added by overriding</span>
    <span class="c1"># this method and adding the following line after a call to super().generate(schema):</span>
    <span class="c1"># json_schema[&#39;$schema&#39;] = self.schema_dialect</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_used</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.generate_definitions" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">generate_definitions</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.generate_definitions" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">generate_definitions</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Given a list of core_schema, generates all JSON schema definitions from a list of core schemas, and
returns the generated definitions paired with a mapping from the input keys to the definition references.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>inputs</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[tuple[<span title="pydantic.json_schema.JsonSchemaKeyT">JsonSchemaKeyT</span>, <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaMode" href="#pydantic.json_schema.JsonSchemaMode">JsonSchemaMode</a>, <a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.CoreSchema">CoreSchema</span>]]</code>
          </td>
          <td><p>A sequence of tuples, where:</p>
<ul>
<li><code>JsonSchemaKeyT</code> will be paired with <code>JsonSchemaMode</code> to form the keys of the first returned
    dictionary.</li>
<li><code>JsonSchemaMode</code> is a JSON schema mode, either 'validation' or 'serialization'.</li>
<li><code>core_schema.CoreSchema</code> is a Pydantic <code>core_schema</code>.</li>
</ul></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[dict[tuple[<span title="pydantic.json_schema.JsonSchemaKeyT">JsonSchemaKeyT</span>, <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaMode" href="#pydantic.json_schema.JsonSchemaMode">JsonSchemaMode</a>], <span title="pydantic.json_schema.DefsRef">DefsRef</span>], dict[<span title="pydantic.json_schema.DefsRef">DefsRef</span>, <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a>]]</code>
          </td>
          <td><p>A 2-tuple, where:</p>
<ul>
<li>The first element is a dictionary whose keys are tuples of a JSON schema key type and mode, and
    whose values are <code>DefsRef</code>.</li>
<li>The second element is a dictionary whose keys are <code>DefsRef</code> and whose values are <code>JsonSchemaValue</code>.</li>
</ul></td>
        </tr>
    </tbody>
  </table>

  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.errors.PydanticUserError" href="../errors/#pydantic.errors.PydanticUserError">PydanticUserError</a></code>
          </td>
          <td><p>Raised if the JSON schema generator has already been used to generate a JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_definitions</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">JsonSchemaKeyT</span><span class="p">,</span> <span class="n">JsonSchemaMode</span><span class="p">,</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">CoreSchema</span><span class="p">]]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">JsonSchemaKeyT</span><span class="p">,</span> <span class="n">JsonSchemaMode</span><span class="p">],</span> <span class="n">DefsRef</span><span class="p">],</span> <span class="nb">dict</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Given a list of core_schema, generates all JSON schema definitions from a list of core schemas, and</span>
<span class="sd">    returns the generated definitions paired with a mapping from the input keys to the definition references.</span>

<span class="sd">    Args:</span>
<span class="sd">        inputs: A sequence of tuples, where:</span>

<span class="sd">            - `JsonSchemaKeyT` will be paired with `JsonSchemaMode` to form the keys of the first returned</span>
<span class="sd">                dictionary.</span>
<span class="sd">            - `JsonSchemaMode` is a JSON schema mode, either &#39;validation&#39; or &#39;serialization&#39;.</span>
<span class="sd">            - `core_schema.CoreSchema` is a Pydantic `core_schema`.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 2-tuple, where:</span>

<span class="sd">            - The first element is a dictionary whose keys are tuples of a JSON schema key type and mode, and</span>
<span class="sd">                whose values are `DefsRef`.</span>
<span class="sd">            - The second element is a dictionary whose keys are `DefsRef` and whose values are `JsonSchemaValue`.</span>

<span class="sd">    Raises:</span>
<span class="sd">        PydanticUserError: Raised if the JSON schema generator has already been used to generate a JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_used</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">PydanticUserError</span><span class="p">(</span>
            <span class="s1">&#39;This JSON schema generator has already been used to generate a JSON schema. &#39;</span>
            <span class="sa">f</span><span class="s1">&#39;You must create a new instance of </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1"> to generate a new JSON schema.&#39;</span><span class="p">,</span>
            <span class="n">code</span><span class="o">=</span><span class="s1">&#39;json-schema-already-used&#39;</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">resolve_collisions</span><span class="p">({})</span>

    <span class="n">refs_map</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">JsonSchemaKeyT</span><span class="p">,</span> <span class="n">JsonSchemaMode</span><span class="p">],</span> <span class="n">DefsRef</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">schema</span> <span class="ow">in</span> <span class="n">inputs</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">mode</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
            <span class="n">json_ref</span> <span class="o">=</span> <span class="n">cast</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">])</span>
            <span class="n">defs_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">json_ref</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">defs_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">refs_map</span><span class="p">[(</span><span class="n">key</span><span class="p">,</span> <span class="n">mode</span><span class="p">)]</span> <span class="o">=</span> <span class="n">defs_ref</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_used</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="n">refs_map</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.generate_inner" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">generate_inner</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.generate_inner" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Generates a JSON schema for a given <code>CoreSchemaOrField</code>.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><span title="pydantic._internal._core_utils.CoreSchemaOrField">CoreSchemaOrField</span></code>
          </td>
          <td><p>The given <code>CoreSchemaOrField</code> to generate JSON schema for.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_inner</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generates a JSON schema for a given `CoreSchemaOrField`.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (CoreSchemaOrField): The given `CoreSchemaOrField` to generate JSON schema for.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># If a schema with the same CoreRef has been handled, just return a reference to it</span>
    <span class="c1"># Note that this assumes that it will _never_ be the case that the same CoreRef is used</span>
    <span class="c1"># on types that should have different JSON schemas</span>
    <span class="k">if</span> <span class="s1">&#39;ref&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">core_ref</span> <span class="o">=</span> <span class="n">CoreRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore[typeddict-item]</span>
        <span class="n">core_mode_ref</span> <span class="o">=</span> <span class="p">(</span><span class="n">core_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">core_mode_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">:</span>
            <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]}</span>

    <span class="c1"># Generate the JSON schema, accounting for the json_schema_override and core_schema_override</span>
    <span class="n">metadata_handler</span> <span class="o">=</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">CoreMetadataHandler</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">handler_func</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate a JSON schema based on the input schema.</span>

<span class="sd">        Args:</span>
<span class="sd">            schema_or_field (CoreSchemaOrField): The schema data to generate a JSON schema from.</span>

<span class="sd">        Returns:</span>
<span class="sd">            JsonSchemaValue: The generated JSON schema.</span>

<span class="sd">        Raises:</span>
<span class="sd">            TypeError: If an unexpected schema type is encountered.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Generate the core-schema-type-specific bits of the schema generation:</span>
        <span class="k">if</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">)</span> <span class="ow">or</span> <span class="n">_core_utils</span><span class="o">.</span><span class="n">is_core_schema_field</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">):</span>
            <span class="n">generate_for_schema_type</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_schema_type_to_method</span><span class="p">[</span><span class="n">schema_or_field</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]]</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="n">generate_for_schema_type</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Unexpected schema type: schema=</span><span class="si">{</span><span class="n">schema_or_field</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="c1"># Populate the definitions</span>
        <span class="k">if</span> <span class="s1">&#39;ref&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
            <span class="n">core_ref</span> <span class="o">=</span> <span class="n">CoreRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;ref&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore[typeddict-item]</span>
            <span class="n">defs_ref</span><span class="p">,</span> <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_cache_defs_ref_schema</span><span class="p">(</span><span class="n">core_ref</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="n">defs_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_schema</span>
            <span class="n">json_schema</span> <span class="o">=</span> <span class="n">ref_json_schema</span>
        <span class="k">return</span> <span class="n">json_schema</span>

    <span class="n">current_handler</span> <span class="o">=</span> <span class="n">_schema_generation_shared</span><span class="o">.</span><span class="n">GenerateJsonSchemaHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">handler_func</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">js_modify_function</span> <span class="ow">in</span> <span class="n">metadata_handler</span><span class="o">.</span><span class="n">metadata</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;pydantic_js_functions&#39;</span><span class="p">,</span> <span class="p">()):</span>

        <span class="k">def</span> <span class="nf">new_handler_func</span><span class="p">(</span>
            <span class="n">schema_or_field</span><span class="p">:</span> <span class="n">CoreSchemaOrField</span><span class="p">,</span>
            <span class="n">current_handler</span><span class="p">:</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">GetJsonSchemaHandler</span> <span class="o">=</span> <span class="n">current_handler</span><span class="p">,</span>
            <span class="n">js_modify_function</span><span class="p">:</span> <span class="n">_core_metadata</span><span class="o">.</span><span class="n">GetJsonSchemaFunction</span> <span class="o">=</span> <span class="n">js_modify_function</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">js_modify_function</span><span class="p">(</span><span class="n">schema_or_field</span><span class="p">,</span> <span class="n">current_handler</span><span class="p">)</span>

        <span class="n">current_handler</span> <span class="o">=</span> <span class="n">_schema_generation_shared</span><span class="o">.</span><span class="n">GenerateJsonSchemaHandler</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_handler_func</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">current_handler</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.generator_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">generator_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.generator_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">generator_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a JSON schema that represents the provided GeneratorSchema.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.GeneratorSchema">GeneratorSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generator_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">GeneratorSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a JSON schema that represents the provided GeneratorSchema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">items_schema</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="s1">&#39;items_schema&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items_schema</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.get_cache_defs_ref_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_cache_defs_ref_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.get_cache_defs_ref_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">get_cache_defs_ref_schema</span><span class="p">(</span><span class="n">core_ref</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This method wraps the get_defs_ref method with some cache-lookup/population logic,
and returns both the produced defs_ref and the JSON schema that will refer to the right definition.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_cache_defs_ref_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core_ref</span><span class="p">:</span> <span class="n">CoreRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">DefsRef</span><span class="p">,</span> <span class="n">JsonSchemaValue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method wraps the get_defs_ref method with some cache-lookup/population logic,</span>
<span class="sd">    and returns both the produced defs_ref and the JSON schema that will refer to the right definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">core_mode_ref</span> <span class="o">=</span> <span class="p">(</span><span class="n">core_ref</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode</span><span class="p">)</span>
    <span class="n">maybe_defs_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">core_mode_ref</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">maybe_defs_ref</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">json_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">maybe_defs_ref</span><span class="p">,</span> <span class="p">{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_ref</span><span class="p">}</span>

    <span class="n">defs_ref</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_defs_ref</span><span class="p">(</span><span class="n">core_mode_ref</span><span class="p">)</span>

    <span class="c1"># populate the ref translation mappings</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">core_to_defs_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">defs_ref</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="p">[</span><span class="n">defs_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">core_mode_ref</span>

    <span class="n">json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ref_template</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">model</span><span class="o">=</span><span class="n">defs_ref</span><span class="p">))</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">core_to_json_refs</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">json_ref</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">defs_ref</span>
    <span class="n">ref_json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_ref</span><span class="p">}</span>
    <span class="k">return</span> <span class="n">defs_ref</span><span class="p">,</span> <span class="n">ref_json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.get_defs_ref" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_defs_ref</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.get_defs_ref" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">get_defs_ref</span><span class="p">(</span><span class="n">core_mode_ref</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Override this method to change the way that definitions keys are generated from a core reference.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span>
<span class="normal">1272</span>
<span class="normal">1273</span>
<span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_defs_ref</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">core_mode_ref</span><span class="p">:</span> <span class="n">CoreModeRef</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">DefsRef</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Override this method to change the way that definitions keys are generated from a core reference.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Split the core ref into &quot;components&quot;; generic origins and arguments are each separate components</span>
    <span class="n">core_ref</span><span class="p">,</span> <span class="n">mode</span> <span class="o">=</span> <span class="n">core_mode_ref</span>
    <span class="n">components</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;([\][,])&#39;</span><span class="p">,</span> <span class="n">core_ref</span><span class="p">)</span>
    <span class="c1"># Remove IDs from each component</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;:&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>
    <span class="n">core_ref_no_id</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>
    <span class="c1"># Remove everything before the last period from each &quot;component&quot;</span>
    <span class="n">components</span> <span class="o">=</span> <span class="p">[</span><span class="n">re</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="sa">r</span><span class="s1">&#39;(?:[^.[\]]+\.)+((?:[^.[\]]+))&#39;</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;\1&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">components</span><span class="p">]</span>
    <span class="n">short_ref</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">components</span><span class="p">)</span>

    <span class="n">mode_title</span> <span class="o">=</span> <span class="n">_MODE_TITLE_MAPPING</span><span class="p">[</span><span class="n">mode</span><span class="p">]</span>
    <span class="c1"># It is important that the generated defs_ref values be such that at least one could not</span>
    <span class="c1"># be generated for any other core_ref. Currently, this should be the case because we include</span>
    <span class="c1"># the id of the source type in the core_ref</span>
    <span class="n">choices</span> <span class="o">=</span> <span class="p">[</span>
        <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">short_ref</span><span class="p">)),</span>  <span class="c1"># name</span>
        <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">short_ref</span> <span class="o">+</span> <span class="n">mode_title</span><span class="p">)),</span>  <span class="c1"># name + mode</span>
        <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref_no_id</span><span class="p">)),</span>  <span class="c1"># module + qualname</span>
        <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref_no_id</span> <span class="o">+</span> <span class="n">mode_title</span><span class="p">)),</span>  <span class="c1"># module + qualname + mode</span>
        <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref</span><span class="p">)),</span>  <span class="c1"># module + qualname + id</span>
        <span class="n">DefsRef</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">normalize_name</span><span class="p">(</span><span class="n">core_ref</span> <span class="o">+</span> <span class="n">mode_title</span><span class="p">)),</span>  <span class="c1"># module + qualname + id + mode</span>
    <span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">defs_ref_fallbacks</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]</span> <span class="o">=</span> <span class="n">choices</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="n">choices</span><span class="p">:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">core_mode_ref</span><span class="p">)</span> <span class="o">==</span> <span class="n">core_mode_ref</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">choice</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">choices</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>  <span class="c1"># should never get here if the final choice is guaranteed unique</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.get_json_ref_counts" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">get_json_ref_counts</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.get_json_ref_counts" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">get_json_ref_counts</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Get all values corresponding to the key '$ref' anywhere in the json_schema</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_json_ref_counts</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">JsonRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get all values corresponding to the key &#39;$ref&#39; anywhere in the json_schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_refs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="n">JsonRef</span><span class="p">,</span> <span class="nb">int</span><span class="p">]</span> <span class="o">=</span> <span class="n">Counter</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">_add_json_refs</span><span class="p">(</span><span class="n">schema</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                <span class="n">json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">])</span>
                <span class="n">already_visited</span> <span class="o">=</span> <span class="n">json_ref</span> <span class="ow">in</span> <span class="n">json_refs</span>
                <span class="n">json_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="k">if</span> <span class="n">already_visited</span><span class="p">:</span>
                    <span class="k">return</span>  <span class="c1"># prevent recursion on a definition that was already visited</span>
                <span class="n">_add_json_refs</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">definitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">json_to_defs_refs</span><span class="p">[</span><span class="n">json_ref</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
                <span class="n">_add_json_refs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
                <span class="n">_add_json_refs</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>

    <span class="n">_add_json_refs</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_refs</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.handle_ref_overrides" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">handle_ref_overrides</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.handle_ref_overrides" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">handle_ref_overrides</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>It is not valid for a schema with a top-level $ref to have sibling keys.</p>
<p>During our own schema generation, we treat sibling keys as overrides to the referenced schema,
but this is not how the official JSON schema spec works.</p>
<p>Because of this, we first remove any sibling keys that are redundant with the referenced schema, then if
any remain, we transform the schema from a top-level '$ref' to use allOf to move the $ref out of the top level.
(See bottom of https://swagger.io/docs/specification/using-ref/ for a reference about this behavior)</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span>
<span class="normal">1402</span>
<span class="normal">1403</span>
<span class="normal">1404</span>
<span class="normal">1405</span>
<span class="normal">1406</span>
<span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">handle_ref_overrides</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    It is not valid for a schema with a top-level $ref to have sibling keys.</span>

<span class="sd">    During our own schema generation, we treat sibling keys as overrides to the referenced schema,</span>
<span class="sd">    but this is not how the official JSON schema spec works.</span>

<span class="sd">    Because of this, we first remove any sibling keys that are redundant with the referenced schema, then if</span>
<span class="sd">    any remain, we transform the schema from a top-level &#39;$ref&#39; to use allOf to move the $ref out of the top level.</span>
<span class="sd">    (See bottom of https://swagger.io/docs/specification/using-ref/ for a reference about this behavior)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="s1">&#39;$ref&#39;</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="p">:</span>
        <span class="c1"># prevent modifications to the input; this copy may be safe to drop if there is significant overhead</span>
        <span class="n">json_schema</span> <span class="o">=</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

        <span class="n">referenced_json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_schema_from_definitions</span><span class="p">(</span><span class="n">JsonRef</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]))</span>
        <span class="k">if</span> <span class="n">referenced_json_schema</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># This can happen when building schemas for models with not-yet-defined references.</span>
            <span class="c1"># It may be a good idea to do a recursive pass at the end of the generation to remove</span>
            <span class="c1"># any redundant override keys.</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="c1"># Make it an allOf to at least resolve the sibling keys issue</span>
                <span class="n">json_schema</span> <span class="o">=</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
                <span class="n">json_schema</span><span class="o">.</span><span class="n">setdefault</span><span class="p">(</span><span class="s1">&#39;allOf&#39;</span><span class="p">,</span> <span class="p">[])</span>
                <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;allOf&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">({</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]})</span>
                <span class="k">del</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]</span>

            <span class="k">return</span> <span class="n">json_schema</span>
        <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="nb">list</span><span class="p">(</span><span class="n">json_schema</span><span class="o">.</span><span class="n">items</span><span class="p">()):</span>
            <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="s1">&#39;$ref&#39;</span><span class="p">:</span>
                <span class="k">continue</span>
            <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">referenced_json_schema</span> <span class="ow">and</span> <span class="n">referenced_json_schema</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">==</span> <span class="n">v</span><span class="p">:</span>
                <span class="k">del</span> <span class="n">json_schema</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>  <span class="c1"># redundant key</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># There is a remaining &quot;override&quot; key, so we need to move $ref out of the top level</span>
            <span class="n">json_ref</span> <span class="o">=</span> <span class="n">JsonRef</span><span class="p">(</span><span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">])</span>
            <span class="k">del</span> <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$ref&#39;</span><span class="p">]</span>
            <span class="k">assert</span> <span class="s1">&#39;allOf&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">json_schema</span>  <span class="c1"># this should never happen, but just in case</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;allOf&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">[{</span><span class="s1">&#39;$ref&#39;</span><span class="p">:</span> <span class="n">json_ref</span><span class="p">}]</span>

    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.int_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">int_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.int_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">int_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches an int value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.IntSchema">IntSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">int_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">IntSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches an int value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.IntSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;integer&#39;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">numeric</span><span class="p">)</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">json_schema</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">v</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">{</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">,</span> <span class="o">-</span><span class="n">math</span><span class="o">.</span><span class="n">inf</span><span class="p">}}</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.is_instance_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">is_instance_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.is_instance_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">is_instance_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that checks if a value is an instance of a class, equivalent to Python's <code>isinstance</code> method.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.IsInstanceSchema">IsInstanceSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_instance_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">IsInstanceSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that checks if a value is an instance of a class, equivalent to Python&#39;s `isinstance` method.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">handle_invalid_for_json_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;core_schema.IsInstanceSchema (</span><span class="si">{</span><span class="n">schema</span><span class="p">[</span><span class="s2">&quot;cls&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.is_subclass_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">is_subclass_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.is_subclass_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">is_subclass_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that checks if a value is a subtype of a class, equivalent to Python's <code>issubclass</code> method.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.IsSubclassSchema">IsSubclassSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">is_subclass_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">IsSubclassSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that checks if a value is a subtype of a class, equivalent to Python&#39;s `issubclass` method.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Note: This is for compatibility with V1; you can override if you want different behavior.</span>
    <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.json_or_python_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">json_or_python_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.json_or_python_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">json_or_python_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Always uses the json schema</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">887</span>
<span class="normal">888</span>
<span class="normal">889</span>
<span class="normal">890</span>
<span class="normal">891</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">json_or_python_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">JsonOrPythonSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Always uses the json schema</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;json_schema&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.lax_or_strict_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">lax_or_strict_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.lax_or_strict_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">lax_or_strict_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>LaxOrStrict will use the strict branch for serialization internally,
unless it was overridden here.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">873</span>
<span class="normal">874</span>
<span class="normal">875</span>
<span class="normal">876</span>
<span class="normal">877</span>
<span class="normal">878</span>
<span class="normal">879</span>
<span class="normal">880</span>
<span class="normal">881</span>
<span class="normal">882</span>
<span class="normal">883</span>
<span class="normal">884</span>
<span class="normal">885</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">lax_or_strict_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">LaxOrStrictSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    LaxOrStrict will use the strict branch for serialization internally,</span>
<span class="sd">    unless it was overridden here.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># TODO: Need to read the default value off of model config or whatever</span>
    <span class="n">use_strict</span> <span class="o">=</span> <span class="n">schema</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;strict&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>  <span class="c1"># TODO: replace this default False</span>
    <span class="c1"># If your JSON schema fails to generate it is probably</span>
    <span class="c1"># because one of the following two branches failed.</span>
    <span class="k">if</span> <span class="n">use_strict</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;strict_schema&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;lax_schema&#39;</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.list_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">list_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.list_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">list_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>List</code> value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.ListSchema">ListSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">list_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">ListSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `List` value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">items_schema</span> <span class="o">=</span> <span class="p">{}</span> <span class="k">if</span> <span class="s1">&#39;items_schema&#39;</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">schema</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items_schema</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.literal_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">literal_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.literal_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">literal_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>Literal</code> value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.LiteralSchema">LiteralSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">literal_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">LiteralSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `Literal` value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.LiteralSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">expected</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="o">.</span><span class="n">value</span> <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">v</span><span class="p">,</span> <span class="n">Enum</span><span class="p">)</span> <span class="k">else</span> <span class="n">v</span> <span class="k">for</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;expected&#39;</span><span class="p">]]</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">expected</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;const&#39;</span><span class="p">:</span> <span class="n">expected</span><span class="p">[</span><span class="mi">0</span><span class="p">]}</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;enum&#39;</span><span class="p">:</span> <span class="n">expected</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.none_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">none_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.none_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">none_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>None</code> value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.NoneSchema">NoneSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">none_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">NoneSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `None` value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.NoneSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;null&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.render_warning_message" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">render_warning_message</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.render_warning_message" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">render_warning_message</span><span class="p">(</span><span class="n">kind</span><span class="p">,</span> <span class="n">detail</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This method is responsible for ignoring warnings as desired, and for formatting the warning messages.</p>
<p>You can override the value of <code>ignored_warning_kinds</code> in a subclass of GenerateJsonSchema
to modify what warnings are generated. If you want more control, you can override this method;
just return None in situations where you don't want warnings to be emitted.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">render_warning_message</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="n">JsonSchemaWarningKind</span><span class="p">,</span> <span class="n">detail</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This method is responsible for ignoring warnings as desired, and for formatting the warning messages.</span>

<span class="sd">    You can override the value of `ignored_warning_kinds` in a subclass of GenerateJsonSchema</span>
<span class="sd">    to modify what warnings are generated. If you want more control, you can override this method;</span>
<span class="sd">    just return None in situations where you don&#39;t want warnings to be emitted.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kind</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ignored_warning_kinds</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">None</span>
    <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">detail</span><span class="si">}</span><span class="s1"> [</span><span class="si">{</span><span class="n">kind</span><span class="si">}</span><span class="s1">]&#39;</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.resolve_collisions" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">resolve_collisions</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.resolve_collisions" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">resolve_collisions</span><span class="p">(</span><span class="n">json_schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>This function ensures that any defs_ref's that were involved in collisions
(due to simplification of the core_ref) get updated, even if they were the
first occurrence of the colliding defs_ref.</p>
<p>This is intended to prevent confusion where the type that gets the "shortened"
ref depends on the order in which the types were visited.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">resolve_collisions</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This function ensures that any defs_ref&#39;s that were involved in collisions</span>
<span class="sd">    (due to simplification of the core_ref) get updated, even if they were the</span>
<span class="sd">    first occurrence of the colliding defs_ref.</span>

<span class="sd">    This is intended to prevent confusion where the type that gets the &quot;shortened&quot;</span>
<span class="sd">    ref depends on the order in which the types were visited.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">made_changes</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="c1"># Note that because the defs ref choices eventually produce values that use the IDs and</span>
    <span class="c1"># should _never_ collide, it should not be possible for this while loop to run forever</span>
    <span class="k">while</span> <span class="n">made_changes</span><span class="p">:</span>
        <span class="n">made_changes</span> <span class="o">=</span> <span class="kc">False</span>

        <span class="k">for</span> <span class="n">defs_ref</span><span class="p">,</span> <span class="n">core_mode_ref</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="n">defs_ref</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="p">:</span>
                <span class="k">continue</span>

            <span class="k">for</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_ref_fallbacks</span><span class="p">[</span><span class="n">core_mode_ref</span><span class="p">]:</span>
                <span class="k">if</span> <span class="n">choice</span> <span class="o">==</span> <span class="n">defs_ref</span> <span class="ow">or</span> <span class="n">choice</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="p">:</span>
                    <span class="k">continue</span>

                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">defs_to_core_refs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">choice</span><span class="p">,</span> <span class="n">core_mode_ref</span><span class="p">)</span> <span class="o">==</span> <span class="n">core_mode_ref</span><span class="p">:</span>
                    <span class="n">json_schema</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">change_defs_ref</span><span class="p">(</span><span class="n">defs_ref</span><span class="p">,</span> <span class="n">choice</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">)</span>
                    <span class="n">made_changes</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">collisions</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">choice</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">made_changes</span><span class="p">:</span>
                <span class="k">break</span>

    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.set_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">set_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.set_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>Set</code> schema.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.SetSchema">SetSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">set_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">SetSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `Set` schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_common_set_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.str_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">str_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.str_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">str_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a string value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.StringSchema">StringSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">str_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">StringSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a string value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.StringSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.time_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">time_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.time_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">time_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a time value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.TimeSchema">TimeSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">time_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TimeSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a time value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.TimeSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;time&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.timedelta_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">timedelta_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.timedelta_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">timedelta_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a <code>timedelta</code> value.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.TimedeltaSchema">TimedeltaSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">timedelta_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TimedeltaSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a `timedelta` value.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (core_schema.TimedeltaSchema): The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;string&#39;</span><span class="p">,</span> <span class="s1">&#39;format&#39;</span><span class="p">:</span> <span class="s1">&#39;duration&#39;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.tuple_positional_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">tuple_positional_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.tuple_positional_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">tuple_positional_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a tuple of schemas.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.TuplePositionalSchema">TuplePositionalSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tuple_positional_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TuplePositionalSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a tuple of schemas.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">}</span>
    <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;minItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
    <span class="n">prefixItems</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">]]</span>
    <span class="k">if</span> <span class="n">prefixItems</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;prefixItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">prefixItems</span>
    <span class="k">if</span> <span class="s1">&#39;extra_schema&#39;</span> <span class="ow">in</span> <span class="n">schema</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;items&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;extra_schema&#39;</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;maxItems&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.tuple_variable_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">tuple_variable_schema</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.tuple_variable_schema" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">tuple_variable_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Returns a schema that matches a tuple of a given schema.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic_core.core_schema" href="../pydantic_core_schema/#pydantic_core.core_schema">core_schema</a>.<span title="pydantic_core.core_schema.TupleVariableSchema">TupleVariableSchema</span></code>
          </td>
          <td><p>The schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The generated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">tuple_variable_schema</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">schema</span><span class="p">:</span> <span class="n">core_schema</span><span class="o">.</span><span class="n">TupleVariableSchema</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Returns a schema that matches a tuple of a given schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema: The schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The generated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># NOTE: The `items_schema` is always added, even when we explicitly create a</span>
    <span class="c1"># tuple variable schema without an `items_schema`.</span>
    <span class="n">items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">generate_inner</span><span class="p">(</span><span class="n">schema</span><span class="p">[</span><span class="s1">&#39;items_schema&#39;</span><span class="p">])</span>  <span class="c1"># type: ignore</span>
    <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;type&#39;</span><span class="p">:</span> <span class="s1">&#39;array&#39;</span><span class="p">,</span> <span class="s1">&#39;items&#39;</span><span class="p">:</span> <span class="n">items</span><span class="p">}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">schema</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">ValidationsMapping</span><span class="o">.</span><span class="n">array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h3 id="pydantic.json_schema.GenerateJsonSchema.update_with_validations" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">update_with_validations</span>


<a href="#pydantic.json_schema.GenerateJsonSchema.update_with_validations" class="headerlink" title="Permanent link">&para;</a></h3>
<div class="highlight"><pre><span></span><code><span class="n">update_with_validations</span><span class="p">(</span><span class="n">json_schema</span><span class="p">,</span> <span class="n">core_schema</span><span class="p">,</span> <span class="n">mapping</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Update the json_schema with the corresponding validations specified in the core_schema,
using the provided mapping to translate keys in core_schema to the appropriate keys for a JSON schema.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_with_validations</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">json_schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">,</span> <span class="n">core_schema</span><span class="p">:</span> <span class="n">CoreSchema</span><span class="p">,</span> <span class="n">mapping</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update the json_schema with the corresponding validations specified in the core_schema,</span>
<span class="sd">    using the provided mapping to translate keys in core_schema to the appropriate keys for a JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">for</span> <span class="n">core_key</span><span class="p">,</span> <span class="n">json_schema_key</span> <span class="ow">in</span> <span class="n">mapping</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="k">if</span> <span class="n">core_key</span> <span class="ow">in</span> <span class="n">core_schema</span><span class="p">:</span>
            <span class="n">json_schema</span><span class="p">[</span><span class="n">json_schema_key</span><span class="p">]</span> <span class="o">=</span> <span class="n">core_schema</span><span class="p">[</span><span class="n">core_key</span><span class="p">]</span>  <span class="c1"># type: ignore[literal-required]</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>

<div class="doc doc-object doc-class">



<h2 id="pydantic.json_schema.PydanticJsonSchemaWarning" class="doc doc-heading">
        <span class="doc doc-object-name doc-class-name">PydanticJsonSchemaWarning</span>


<a href="#pydantic.json_schema.PydanticJsonSchemaWarning" class="headerlink" title="Permanent link">&para;</a></h2>


  <div class="doc doc-contents ">
      <p class="doc doc-class-bases">
        Bases: <code>UserWarning</code></p>

  
      <p>This class is used to emit warnings produced during JSON schema generation.
See the <code>GenerateJsonSchema.emit_warning</code> and <code>GenerateJsonSchema.render_warning_message</code>
methods for more details; these can be overridden to control warning behavior.</p>


        <details class="quote">
          <summary>Source code in <code>pydantic/json_schema.py</code></summary>
          <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">PydanticJsonSchemaWarning</span><span class="p">(</span><span class="ne">UserWarning</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    This class is used to emit warnings produced during JSON schema generation.</span>
<span class="sd">    See the `GenerateJsonSchema.emit_warning` and `GenerateJsonSchema.render_warning_message`</span>
<span class="sd">    methods for more details; these can be overridden to control warning behavior.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
        </details>

  </div>

</div>


<div class="doc doc-object doc-function">



<h2 id="pydantic.json_schema.model_json_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">model_json_schema</span>


<a href="#pydantic.json_schema.model_json_schema" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">model_json_schema</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="o">=</span><span class="n">DEFAULT_REF_TEMPLATE</span><span class="p">,</span>
    <span class="n">schema_generator</span><span class="o">=</span><span class="n">GenerateJsonSchema</span><span class="p">,</span>
    <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;validation&quot;</span><span class="p">,</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Utility function to generate a JSON Schema for a model.</p>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">model_json_schema</span><span class="p">(</span>
    <span class="bp">cls</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="n">PydanticDataclass</span><span class="p">],</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_REF_TEMPLATE</span><span class="p">,</span>
    <span class="n">schema_generator</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">GenerateJsonSchema</span><span class="p">]</span> <span class="o">=</span> <span class="n">GenerateJsonSchema</span><span class="p">,</span>
    <span class="n">mode</span><span class="p">:</span> <span class="n">JsonSchemaMode</span> <span class="o">=</span> <span class="s1">&#39;validation&#39;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility function to generate a JSON Schema for a model.&quot;&quot;&quot;</span>
    <span class="n">schema_generator_instance</span> <span class="o">=</span> <span class="n">schema_generator</span><span class="p">(</span><span class="n">by_alias</span><span class="o">=</span><span class="n">by_alias</span><span class="p">,</span> <span class="n">ref_template</span><span class="o">=</span><span class="n">ref_template</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">schema_generator_instance</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="bp">cls</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">mode</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pydantic.json_schema.models_json_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">models_json_schema</span>


<a href="#pydantic.json_schema.models_json_schema" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">models_json_schema</span><span class="p">(</span>
    <span class="n">models</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="o">=</span><span class="n">DEFAULT_REF_TEMPLATE</span><span class="p">,</span>
    <span class="n">schema_generator</span><span class="o">=</span><span class="n">GenerateJsonSchema</span>
<span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Utility function to generate a JSON Schema for multiple models.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>models</code></td>
          <td>
                <code><span title="typing.Sequence">Sequence</span>[tuple[type[<a class="autorefs autorefs-internal" title="pydantic.main.BaseModel" href="../main/#pydantic.main.BaseModel">BaseModel</a>] | type[<span title="pydantic._internal._dataclasses.PydanticDataclass">PydanticDataclass</span>], <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaMode" href="#pydantic.json_schema.JsonSchemaMode">JsonSchemaMode</a>]]</code>
          </td>
          <td><p>A sequence of tuples of the form (model, mode).</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>by_alias</code></td>
          <td>
                <code>bool</code>
          </td>
          <td><p>Whether field aliases should be used as keys in the generated JSON Schema.</p></td>
          <td>
                <code>True</code>
          </td>
        </tr>
        <tr>
          <td><code>title</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td><p>The title of the generated JSON Schema.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>description</code></td>
          <td>
                <code>str | None</code>
          </td>
          <td><p>The description of the generated JSON Schema.</p></td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>ref_template</code></td>
          <td>
                <code>str</code>
          </td>
          <td><p>The reference template to use for generating JSON Schema references.</p></td>
          <td>
                <code>DEFAULT_REF_TEMPLATE</code>
          </td>
        </tr>
        <tr>
          <td><code>schema_generator</code></td>
          <td>
                <code>type[<a class="autorefs autorefs-internal" title="pydantic.json_schema.GenerateJsonSchema" href="#pydantic.json_schema.GenerateJsonSchema">GenerateJsonSchema</a>]</code>
          </td>
          <td><p>The schema generator to use for generating the JSON Schema.</p></td>
          <td>
                <code>GenerateJsonSchema</code>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>tuple[dict[tuple[type[<a class="autorefs autorefs-internal" title="pydantic.main.BaseModel" href="../main/#pydantic.main.BaseModel">BaseModel</a>] | type[<span title="pydantic._internal._dataclasses.PydanticDataclass">PydanticDataclass</span>], <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaMode" href="#pydantic.json_schema.JsonSchemaMode">JsonSchemaMode</a>], <span title="pydantic.json_schema.DefsRef">DefsRef</span>], <a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a>]</code>
          </td>
          <td><p>A 2-tuple, where:
- The first element is a dictionary whose keys are tuples of a JSON schema key type and mode, and
    whose values are <code>DefsRef</code>.
- The second element is the generated JSON Schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">models_json_schema</span><span class="p">(</span>
    <span class="n">models</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="n">PydanticDataclass</span><span class="p">],</span> <span class="n">JsonSchemaMode</span><span class="p">]],</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">by_alias</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="n">title</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">description</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">ref_template</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="n">DEFAULT_REF_TEMPLATE</span><span class="p">,</span>
    <span class="n">schema_generator</span><span class="p">:</span> <span class="nb">type</span><span class="p">[</span><span class="n">GenerateJsonSchema</span><span class="p">]</span> <span class="o">=</span> <span class="n">GenerateJsonSchema</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">type</span><span class="p">[</span><span class="n">BaseModel</span><span class="p">]</span> <span class="o">|</span> <span class="nb">type</span><span class="p">[</span><span class="n">PydanticDataclass</span><span class="p">],</span> <span class="n">JsonSchemaMode</span><span class="p">],</span> <span class="n">DefsRef</span><span class="p">],</span> <span class="n">JsonSchemaValue</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Utility function to generate a JSON Schema for multiple models.</span>

<span class="sd">    Args:</span>
<span class="sd">        models: A sequence of tuples of the form (model, mode).</span>
<span class="sd">        by_alias: Whether field aliases should be used as keys in the generated JSON Schema.</span>
<span class="sd">        title: The title of the generated JSON Schema.</span>
<span class="sd">        description: The description of the generated JSON Schema.</span>
<span class="sd">        ref_template: The reference template to use for generating JSON Schema references.</span>
<span class="sd">        schema_generator: The schema generator to use for generating the JSON Schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A 2-tuple, where:</span>
<span class="sd">            - The first element is a dictionary whose keys are tuples of a JSON schema key type and mode, and</span>
<span class="sd">                whose values are `DefsRef`.</span>
<span class="sd">            - The second element is the generated JSON Schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">instance</span> <span class="o">=</span> <span class="n">schema_generator</span><span class="p">(</span><span class="n">by_alias</span><span class="o">=</span><span class="n">by_alias</span><span class="p">,</span> <span class="n">ref_template</span><span class="o">=</span><span class="n">ref_template</span><span class="p">)</span>
    <span class="n">inputs</span> <span class="o">=</span> <span class="p">[(</span><span class="n">m</span><span class="p">,</span> <span class="n">mode</span><span class="p">,</span> <span class="n">m</span><span class="o">.</span><span class="n">__pydantic_core_schema__</span><span class="p">)</span> <span class="k">for</span> <span class="n">m</span><span class="p">,</span> <span class="n">mode</span> <span class="ow">in</span> <span class="n">models</span><span class="p">]</span>
    <span class="n">key_map</span><span class="p">,</span> <span class="n">definitions</span> <span class="o">=</span> <span class="n">instance</span><span class="o">.</span><span class="n">generate_definitions</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>

    <span class="n">json_schema</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">definitions</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;$defs&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">definitions</span>
    <span class="k">if</span> <span class="n">title</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;title&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">title</span>
    <span class="k">if</span> <span class="n">description</span><span class="p">:</span>
        <span class="n">json_schema</span><span class="p">[</span><span class="s1">&#39;description&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">description</span>

    <span class="k">return</span> <span class="n">key_map</span><span class="p">,</span> <span class="n">json_schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>

<div class="doc doc-object doc-function">



<h2 id="pydantic.json_schema.update_json_schema" class="doc doc-heading">
        <span class="doc doc-object-name doc-function-name">update_json_schema</span>


<a href="#pydantic.json_schema.update_json_schema" class="headerlink" title="Permanent link">&para;</a></h2>
<div class="highlight"><pre><span></span><code><span class="n">update_json_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">,</span> <span class="n">updates</span><span class="p">)</span>
</code></pre></div>

  <div class="doc doc-contents ">
  
      <p>Update a JSON schema by providing a dictionary of updates.</p>
<p>This function sets the provided key-value pairs in the schema and returns the updated schema.</p>

  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>schema</code></td>
          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The JSON schema to update.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>updates</code></td>
          <td>
                <code>dict[str, <span title="typing.Any">Any</span>]</code>
          </td>
          <td><p>A dictionary of key-value pairs to set in the schema.</p></td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>

  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>JsonSchemaValue</code></td>          <td>
                <code><a class="autorefs autorefs-internal" title="pydantic.json_schema.JsonSchemaValue" href="#pydantic.json_schema.JsonSchemaValue">JsonSchemaValue</a></code>
          </td>
          <td><p>The updated JSON schema.</p></td>
        </tr>
    </tbody>
  </table>

      <details class="quote">
        <summary>Source code in <code>pydantic/json_schema.py</code></summary>
        <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">update_json_schema</span><span class="p">(</span><span class="n">schema</span><span class="p">:</span> <span class="n">JsonSchemaValue</span><span class="p">,</span> <span class="n">updates</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">JsonSchemaValue</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Update a JSON schema by providing a dictionary of updates.</span>

<span class="sd">    This function sets the provided key-value pairs in the schema and returns the updated schema.</span>

<span class="sd">    Args:</span>
<span class="sd">        schema (JsonSchemaValue): The JSON schema to update.</span>
<span class="sd">        updates (dict[str, Any]): A dictionary of key-value pairs to set in the schema.</span>

<span class="sd">    Returns:</span>
<span class="sd">        JsonSchemaValue: The updated JSON schema.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">schema</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">updates</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">schema</span>
</code></pre></div></td></tr></table></div>
      </details>
  </div>

</div>



  </div>

  </div>

</div>





                
  <script src="/flarelytics/client.js"></script>

              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var tab,labels=set.querySelector(".tabbed-labels");for(tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.tabs.link", "announce.dismiss", "navigation.tabs"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.b4d07000.min.js"></script>
      
        <script src="../../extra/redirects.js"></script>
      
    
  </body>
</html>